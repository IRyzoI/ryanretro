<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ryan Retro | Benchmarks</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;700;900&family=Plus+Jakarta+Sans:wght@400;500;600&family=Kanit:ital,wght@0,300;0,400;0,600;0,800;1,800&family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet">

    <style>
        /* --- THEME --- */
        :root {
            --bg-deep: #1a0b2e;
            --bg-gradient: radial-gradient(circle at top center, #3b0764, #1a0b2e);
            
            --card-border: rgba(255, 255, 255, 0.2); 
            --card-border-hover: rgba(255, 255, 255, 0.5);
            
            --accent-yellow: #fbbf24;
            --accent-red: #ef4444; 
            --accent-purple: #a855f7;
            --accent-cyan: #22d3ee;
            
            --text-main: #ffffff;
            --text-sub: #e2e8f0;

            --bg-card: #3D255D;
        }

        body {
            background-color: var(--bg-deep);
            background-image: var(--bg-gradient);
            color: var(--text-main);
            font-family: 'Plus Jakarta Sans', sans-serif;
            overflow-x: hidden;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Typography */
        .font-display { font-family: 'Outfit', sans-serif; }
        .font-logo { font-family: 'Kanit', sans-serif; font-weight: 800; letter-spacing: -0.02em; }
        .font-retro { font-family: 'Kanit', sans-serif; font-weight: 800; letter-spacing: 0.05em; text-transform: uppercase; }
        .font-pixel { font-family: 'VT323', monospace; }
        .font-body { font-family: 'Plus Jakarta Sans', sans-serif; }
        
        /* Bento Card Styles (Flat Theme) */
        .bento-card {
            border: 2px solid var(--card-border);
            border-radius: 32px;
            transition: all 0.2s ease-in-out;
            overflow: hidden;
            position: relative;
            box-shadow: 0 8px 0 rgba(0,0,0,0.3); 
            transform: translateY(0);
            background-color: var(--bg-card); /* Default card bg */
        }
        .bento-card:hover {
            transform: translateY(-4px);
            border-color: var(--card-border-hover);
            box-shadow: 0 12px 0 rgba(0,0,0,0.3);
        }

        /* Nav Pills */
        .nav-pill {
            padding: 8px 16px;
            border-radius: 999px;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            color: rgba(255,255,255,0.7);
            transition: all 0.2s;
            border: 1px solid transparent;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .nav-pill:hover, .nav-pill.active {
            color: white;
            background: rgba(255,255,255,0.1);
            border-color: rgba(255,255,255,0.2);
        }

        /* Social Buttons */
        .social-btn {
            width: 36px; height: 36px;
            display: flex; align-items: center; justify-content: center;
            border-radius: 50%;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            color: rgba(255,255,255,0.7);
            transition: all 0.2s;
        }
        .social-btn:hover {
            background: rgba(255,255,255,0.15);
            border-color: rgba(255,255,255,0.3);
            color: white;
            transform: translateY(-2px);
        }

        /* --- BENCHMARK SPECIFIC --- */
        
        /* Controls Panel Dynamic Colors */
        #controlsPanel {
            transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
        }

        /* Mode Colors */
        .panel-yellow {
            background-color: #fbbf24 !important; /* Yellow */
            color: #451a03 !important;
            border-color: #f59e0b !important;
        }
        .panel-red {
            background-color: #be123c !important; /* Rose/Red */
            color: white !important;
            border-color: #9f1239 !important;
        }
        .panel-blue {
            background-color: #2563eb !important; /* Darker Blue (Royal Blue) */
            color: white !important;
            border-color: #1d4ed8 !important;
        }

        /* Toggle Buttons inside colored panel */
        .toggle-btn {
            padding: 8px 16px;
            border-radius: 12px;
            font-family: 'Kanit', sans-serif;
            font-weight: 700;
            font-size: 12px;
            text-transform: uppercase;
            border: 2px solid rgba(255,255,255,0.2);
            background: rgba(0,0,0,0.2); /* Semi-transparent */
            color: inherit;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }
        .toggle-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        .toggle-btn.active {
            background: white;
            color: black;
            border-color: white;
            transform: scale(1.05);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        .toggle-btn.off {
            opacity: 0.5;
            text-decoration: line-through;
        }

        /* Adjust internal text for dark/light modes */
        .panel-yellow .text-white\/50 { color: rgba(0,0,0,0.5); }
        .panel-red .text-white\/50, .panel-blue .text-white\/50 { color: rgba(255,255,255,0.6); }

        /* Table Styling */
        .rr-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            color: var(--text-sub);
        }
        
        .rr-table th {
            background: #2E1A47; /* Matching dark theme header from handheld logic */
            padding: 16px;
            text-align: center;
            font-family: 'Kanit', sans-serif;
            font-weight: 800;
            text-transform: uppercase;
            font-size: 13px;
            letter-spacing: 0.05em;
            border-bottom: 2px solid rgba(255,255,255,0.1);
            position: sticky;
            top: 0;
            z-index: 50; 
            vertical-align: bottom;
            color: var(--accent-cyan);
        }
        
        .rr-table th:first-child {
            text-align: left;
            position: sticky;
            left: 0;
            z-index: 60;
            background: #2E1A47;
            border-right: 2px solid rgba(255,255,255,0.1);
        }

.rr-table td {
            padding: 12px 16px;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            font-family: 'Plus Jakarta Sans', sans-serif; /* Changed from VT323 */
            font-size: 15px; /* Adjusted from 18px to match the new font weight */
            text-align: center;
            white-space: nowrap;
        }

        .rr-table td:first-child {
            font-family: 'Plus Jakarta Sans', sans-serif;
            font-size: 14px;
            font-weight: 600;
            text-align: left;
            color: white;
            position: sticky;
            left: 0;
            background: #2a1540; /* Slightly different for row header */
            border-right: 2px solid rgba(255,255,255,0.1);
            z-index: 40; 
        }

        /* Row hover effect */
        .rr-table tbody tr {
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .rr-table tbody tr:hover td {
            background: rgba(255,255,255,0.1);
        }
        
        /* Highlight Cells */
        .best-cell {
            background: rgba(16, 185, 129, 0.2) !important;
            color: #34d399 !important;
            font-weight: bold;
            box-shadow: inset 0 0 0 1px rgba(16, 185, 129, 0.5);
        }
        .runs-great {
            background: rgba(132, 204, 22, 0.2) !important;
            color: #a3e635 !important;
        }

        /* Scrollbar */
        .custom-scrollbar::-webkit-scrollbar { height: 10px; width: 10px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: rgba(0,0,0,0.2); border-radius: 5px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 5px; border: 2px solid var(--bg-deep); }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: var(--accent-cyan); }

        /* Sortable */
        th.sortable { cursor: pointer; user-select: none; transition: color 0.2s; }
        th.sortable:hover { color: white; }
        th.sortable::after { content: '↕'; display: inline-block; margin-left: 5px; opacity: 0.3; font-size: 10px; }
        th.sortable[data-sort-dir="asc"]::after { content: '▲'; opacity: 1; color: var(--accent-yellow); }
        th.sortable[data-sort-dir="desc"]::after { content: '▼'; opacity: 1; color: var(--accent-yellow); }

        /* Mini Mode */
        .mini-mode .rr-table th, .mini-mode .rr-table td { padding: 8px; font-size: 12px; }
        .mini-mode .chipset-label { display: none; }

        /* Animations */
        @keyframes popIn { 0% { opacity: 0; transform: scale(0.95); } 100% { opacity: 1; transform: scale(1); } }
        .animate-popIn { animation: popIn 0.3s ease-out forwards; }
    </style>
</head>
<body>

    <div class="fixed top-0 left-0 w-full h-[600px] bg-gradient-to-b from-[#4c1d95]/40 to-transparent -z-10 pointer-events-none"></div>
    <div class="fixed top-[-200px] right-[-200px] w-[600px] h-[600px] bg-purple-600/20 rounded-full blur-[120px] -z-10"></div>

    <header class="sticky top-0 z-50 bg-[#1a0b2e]/95 border-b border-white/10 backdrop-blur-xl">
        <div class="container mx-auto px-4 h-24 flex justify-between items-center">
            
            <a href="/" class="flex items-center gap-3 group shrink-0">
                <div class="w-12 h-12 rounded-2xl bg-white/10 p-1 border-2 border-white/20 group-hover:border-[#fbbf24] transition-all shadow-[0_4px_0_rgba(0,0,0,0.2)] group-hover:shadow-[0_6px_0_rgba(0,0,0,0.2)] group-active:translate-y-1 group-active:shadow-none">
                    <img src="https://raw.githubusercontent.com/IRyzoI/ryanretro/refs/heads/main/images/ryanretrologo.jpg" class="w-full h-full object-cover rounded-xl">
                </div>
                <div class="hidden sm:flex flex-col">
                    <span class="font-display text-xl font-bold text-white tracking-wide leading-none">Ryan Retro</span>
                    <span class="text-[10px] font-bold text-white/40 uppercase tracking-widest mt-1">You're always welcome here</span>
                </div>
            </a>
            
            <nav class="hidden xl:flex items-center gap-1 bg-black/20 p-1.5 rounded-full border border-white/10">
                <a href="/reviews" class="nav-pill"><i data-lucide="star" class="w-3.5 h-3.5"></i> Reviews</a>
                <a href="/benchmarks" class="nav-pill active"><i data-lucide="bar-chart-2" class="w-3.5 h-3.5"></i> Benchmarks</a>
                <a href="/comparisons" class="nav-pill"><i data-lucide="arrow-right-left" class="w-3.5 h-3.5"></i> Comparisons</a>
                <a href="/gotw" class="nav-pill"><i data-lucide="gamepad-2" class="w-3.5 h-3.5"></i> GOTW</a>
                <a href="/patrons" class="nav-pill"><i data-lucide="heart" class="w-3.5 h-3.5"></i> Patrons</a>
            </nav>
            
            <div class="flex items-center gap-4">
                <div class="hidden md:flex items-center gap-2 pr-4 border-r border-white/10">
                    <a href="https://www.youtube.com/@RyanRetro" target="_blank" class="social-btn" title="YouTube"><i data-lucide="youtube" class="w-4 h-4"></i></a>
                    <a href="https://x.com/RyanRetroYT" target="_blank" class="social-btn" title="X (Twitter)">
                        <svg viewBox="0 0 24 24" class="w-4 h-4 fill-current"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
                    </a>
                    <a href="https://www.instagram.com/ryanretroyoutube/" target="_blank" class="social-btn" title="Instagram"><i data-lucide="instagram" class="w-4 h-4"></i></a>
                    <a href="https://www.tiktok.com/@ryanretroyoutube" target="_blank" class="social-btn" title="TikTok">
                        <svg viewBox="0 0 24 24" class="w-4 h-4 fill-current"><path d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"/></svg>
                    </a>
                    <a href="https://discord.gg/RAenS43UV9" target="_blank" class="social-btn" title="Discord"><i data-lucide="message-circle" class="w-4 h-4"></i></a>
                    <a href="https://www.facebook.com/RyanRetroYT" target="_blank" class="social-btn" title="Facebook"><i data-lucide="facebook" class="w-4 h-4"></i></a>
                    <a href="https://www.threads.com/@ryanretroyoutube" target="_blank" class="social-btn" title="Threads"><i data-lucide="at-sign" class="w-4 h-4"></i></a>
                </div>
    
                <a href="/store" id="header-shop-btn" target="_blank" class="hidden sm:flex items-center gap-2 text-xs font-bold text-white/80 hover:text-white transition-colors uppercase tracking-widest px-5 py-2.5 border-2 border-white/10 hover:border-white/30 rounded-full bg-white/5">
                    <i data-lucide="shopping-bag" class="w-4 h-4"></i> Shop
                </a>
                
                <button id="mobile-menu-btn" class="xl:hidden text-white/70 hover:text-white p-2.5 border-2 border-white/10 rounded-xl hover:bg-white/5 transition-colors">
                    <i data-lucide="menu" class="w-6 h-6"></i>
                </button>
            </div>
        </div>
        
        <div id="mobile-menu" class="hidden xl:hidden border-t border-white/10 bg-[#1a0b2e] p-4 flex flex-col gap-2 shadow-2xl">
             <div class="grid grid-cols-2 gap-2 mb-2">
                 <a href="/" class="p-3 font-bold bg-white/5 rounded-xl text-white text-center border border-white/5 hover:border-white/20 transition-all flex items-center justify-center gap-2"><i data-lucide="star" class="w-4 h-4"></i> Reviews</a>
                 <a href="/benchmarks" class="p-3 font-bold bg-white/5 rounded-xl text-white text-center border border-white/5 hover:border-white/20 transition-all flex items-center justify-center gap-2"><i data-lucide="bar-chart-2" class="w-4 h-4"></i> Benchmarks</a>
                 <a href="/comparisons" class="p-3 font-bold bg-white/5 rounded-xl text-white text-center border border-white/5 hover:border-white/20 transition-all flex items-center justify-center gap-2"><i data-lucide="arrow-right-left" class="w-4 h-4"></i> Comparisons</a>
                 <a href="/store" class="p-3 font-bold bg-white/5 rounded-xl text-white text-center border border-white/5 hover:border-white/20 transition-all flex items-center justify-center gap-2"><i data-lucide="shopping-bag" class="w-4 h-4"></i> Shop</a>
                 <a href="/gotw" class="p-3 font-bold bg-white/5 rounded-xl text-white text-center border border-white/5 hover:border-white/20 transition-all flex items-center justify-center gap-2"><i data-lucide="gamepad-2" class="w-4 h-4"></i> GOTW</a>
                 <a href="/patrons" class="p-3 font-bold bg-white/5 rounded-xl text-white text-center border border-white/5 hover:border-white/20 transition-all flex items-center justify-center gap-2"><i data-lucide="heart" class="w-4 h-4"></i> Patrons</a>
             </div>
             
             <div class="flex justify-between items-center mt-2 px-2 pt-4 border-t border-white/10">
                 <span class="text-xs font-bold text-white/30 uppercase">Connect</span>
                 <div class="flex gap-3 flex-wrap justify-end">
                     <a href="https://www.youtube.com/@RyanRetro" target="_blank" class="text-white/60 hover:text-white"><i data-lucide="youtube" class="w-5 h-5"></i></a>
                     <a href="https://x.com/RyanRetroYT" target="_blank" class="text-white/60 hover:text-white"><svg viewBox="0 0 24 24" class="w-5 h-5 fill-current"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg></a>
                     <a href="https://www.instagram.com/ryanretroyoutube/" target="_blank" class="text-white/60 hover:text-white"><i data-lucide="instagram" class="w-5 h-5"></i></a>
                     <a href="https://www.tiktok.com/@ryanretroyoutube" target="_blank" class="text-white/60 hover:text-white"><svg viewBox="0 0 24 24" class="w-5 h-5 fill-current"><path d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"/></svg></a>
                     <a href="https://discord.gg/RAenS43UV9" target="_blank" class="text-white/60 hover:text-white"><i data-lucide="message-circle" class="w-5 h-5"></i></a>
                     <a href="https://www.facebook.com/RyanRetroYT" target="_blank" class="text-white/60 hover:text-white"><i data-lucide="facebook" class="w-5 h-5"></i></a>
                     <a href="https://www.threads.com/@ryanretroyoutube" target="_blank" class="text-white/60 hover:text-white"><i data-lucide="at-sign" class="w-5 h-5"></i></a>
                 </div>
             </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8 flex-grow">

        <section class="mb-8 text-center" data-aos="fade-down">
            <h1 class="font-display font-black text-4xl md:text-5xl text-white drop-shadow-lg mb-2">
                VALUE <span class="text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-orange-500">BENCHMARKS</span>
            </h1>
            <p class="text-white/60 font-medium max-w-2xl mx-auto">
                Compare FPS across handhelds. Click any row to see full details and box art.
            </p>
        </section>

        <div id="controlsPanel" class="bento-card p-6 mb-8 panel-yellow" data-aos="fade-up">
            
            <div class="flex flex-col md:flex-row flex-wrap items-center justify-center gap-6 mb-6 pb-6 border-b border-white/20">
                <div class="flex items-center gap-3">
                    <span class="font-retro text-xs text-white/50 uppercase tracking-widest">System:</span>
                    <button class="toggle-btn mode-toggle active" data-mode="combined">ALL</button>
                    <button class="toggle-btn mode-toggle" data-mode="switch">Switch</button>
                    <button class="toggle-btn mode-toggle" data-mode="windows">Windows</button>
                </div>
            </div>

            <div class="flex flex-col md:flex-row flex-wrap items-center justify-center gap-4 mb-8">
                <span class="font-retro text-xs text-white/50 uppercase tracking-widest">Devices:</span>
                <div class="flex flex-wrap justify-center gap-2">
                    <button class="toggle-btn active device-toggle" data-col-index="1"><span class="w-2 h-2 rounded-full bg-green-500"></span> RP5</button>
                    <button class="toggle-btn active device-toggle" data-col-index="2"><span class="w-2 h-2 rounded-full bg-yellow-400"></span> RPG2</button>
                    <button class="toggle-btn active device-toggle" data-col-index="3"><span class="w-2 h-2 rounded-full bg-blue-400"></span> Odin2P</button>
                    <button class="toggle-btn active device-toggle" data-col-index="4"><span class="w-2 h-2 rounded-full bg-orange-400"></span> Konkr</button>
                    <button class="toggle-btn off device-toggle" data-col-index="5"><span class="w-2 h-2 rounded-full bg-pink-400"></span> Fold7</button>
                    <button class="toggle-btn active device-toggle" data-col-index="6"><span class="w-2 h-2 rounded-full bg-purple-400"></span> Odin3</button>
                    <button class="toggle-btn active device-toggle" data-col-index="7"><span class="w-2 h-2 rounded-full bg-cyan-400"></span> SteamDeck</button>
                </div>
            </div>

            <div class="flex flex-wrap items-center justify-center gap-3">
                <button id="toggleHighlight" class="toggle-btn feat-highlight"><i data-lucide="zap" class="w-3 h-3"></i> Highlight Best</button>
                <button id="toggleColorMode" class="toggle-btn feat-ranking"><i data-lucide="bar-chart" class="w-3 h-3"></i> Ranking Mode</button>
                <button id="toggleValueMode" class="toggle-btn feat-value"><i data-lucide="dollar-sign" class="w-3 h-3"></i> Value Mode</button>
                <button id="toggleRunsGreat" class="toggle-btn feat-great"><i data-lucide="check-circle" class="w-3 h-3"></i> Runs Great</button>
                <button id="toggleMiniMode" class="toggle-btn feat-mini"><i data-lucide="smartphone" class="w-3 h-3"></i> Mini View</button>
            </div>
        </div>

        <div id="benchCard" class="bento-card p-0 overflow-hidden" data-aos="fade-up" data-aos-delay="100">
            <div class="overflow-x-auto custom-scrollbar w-full max-h-[800px]">
                
                <table class="rr-table" data-mode="combined">
                    <thead>
                        <tr>
                            <th class="sortable" data-col="0">Game</th>
                            <th data-col-index="1"><span class="text-green-400">RP5</span><div class="text-[10px] text-white/40 font-normal mt-1 chipset-label">SD 865</div></th>
                            <th data-col-index="2"><span class="text-yellow-400">RPG2</span><div class="text-[10px] text-white/40 font-normal mt-1 chipset-label">G2 Gen 2</div></th>
                            <th data-col-index="3"><span class="text-blue-400">Odin 2 P</span><div class="text-[10px] text-white/40 font-normal mt-1 chipset-label">8 Gen 2</div></th>
                            <th data-col-index="4"><span class="text-orange-400">Konkr</span><div class="text-[10px] text-white/40 font-normal mt-1 chipset-label">G3 Gen 3</div></th>
                            <th data-col-index="5"><span class="text-pink-400">Fold 7</span><div class="text-[10px] text-white/40 font-normal mt-1 chipset-label">8 Elite</div></th>
                            <th data-col-index="6"><span class="text-purple-400">Odin 3</span><div class="text-[10px] text-white/40 font-normal mt-1 chipset-label">8 Elite</div></th>
                            <th data-col-index="7"><span class="text-cyan-400">Steam Deck</span><div class="text-[10px] text-white/40 font-normal mt-1 chipset-label">AMD APU</div></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>Captain Toad: Treasure Tracker</td><td>45</td><td>75</td><td>80</td><td>155</td><td>75</td><td>160</td><td>Untested</td></tr>
                        <tr><td>Cuphead</td><td>130</td><td>175</td><td>-</td><td>280</td><td>140</td><td>318</td><td>60</td></tr>
                        <tr><td>Cyberpunk 2077</td><td>-</td><td>11</td><td>15</td><td>16</td><td>7</td><td>14</td><td>30</td></tr>
                        <tr><td>Donut County</td><td>38</td><td>80</td><td>76</td><td>156</td><td>75</td><td>85</td><td>Untested</td></tr>
                        <tr><td>Elden Ring</td><td>11</td><td>15</td><td>19</td><td>25</td><td>5</td><td>30</td><td>40</td></tr>
                        <tr><td>FIFA 18</td><td>60</td><td>73</td><td>86</td><td>150</td><td>82</td><td>100</td><td>Untested</td></tr>
                        <tr><td>Golf Story</td><td>126</td><td>126</td><td>175</td><td>185</td><td>180</td><td>240</td><td>Untested</td></tr>
                        <tr><td>Gris</td><td>61</td><td>115</td><td>110</td><td>260</td><td>126</td><td>130</td><td>Untested</td></tr>
                        <tr><td>GTA V</td><td>20</td><td>44</td><td>47</td><td>57</td><td>-</td><td>67</td><td>76</td></tr>
                        <tr><td>Hades 2</td><td>51</td><td>67</td><td>-</td><td>124</td><td>105</td><td>190</td><td>150</td></tr>
                        <tr><td>Hollow Knight Silksong</td><td>80</td><td>120</td><td>-</td><td>190</td><td>122</td><td>220</td><td>250</td></tr>
                        <tr><td>Megabonk</td><td>-</td><td>40</td><td>-</td><td>68</td><td>40</td><td>90</td><td>240</td></tr>
                        <tr><td>Monster Boy</td><td>115</td><td>100</td><td>160</td><td>165</td><td>120</td><td>220</td><td>250</td></tr>
                        <tr><td>Need for Speed Rivals</td><td>-</td><td>30</td><td>30</td><td>30</td><td>30</td><td>30</td><td>30</td></tr>
                        <tr><td>Pokémon Sword (Battle)</td><td>40</td><td>70</td><td>84</td><td>123</td><td>95</td><td>130</td><td>Untested</td></tr>
                        <tr><td>Pokémon Sword (Open)</td><td>30</td><td>33</td><td>50</td><td>53</td><td>50</td><td>68</td><td>Untested</td></tr>
                        <tr><td>Skyrim</td><td>25</td><td>36</td><td>57</td><td>57</td><td>47</td><td>57</td><td>60</td></tr>
                        <tr><td>Slay the Spire</td><td>110</td><td>115</td><td>142</td><td>145</td><td>200</td><td>240</td><td>Untested</td></tr>
                        <tr><td>Tennis in the Face</td><td>124</td><td>106</td><td>124</td><td>124</td><td>124</td><td>125</td><td>Untested</td></tr>
                        <tr><td>Tomb Raider</td><td>-</td><td>-</td><td>-</td><td>-</td><td>87</td><td>-</td><td>148</td></tr>
                        <tr><td>Traveller’s Rest</td><td>-</td><td>40</td><td>30</td><td>50</td><td>40</td><td>70</td><td>78</td></tr>
                        <tr><td>Zelda: BOTW</td><td>25</td><td>41</td><td>37</td><td>48</td><td>38</td><td>45</td><td>Untested</td></tr>
                        <tr><td>Zelda: Echoes</td><td>38</td><td>35</td><td>58</td><td>55</td><td>-</td><td>82</td><td>Untested</td></tr>
                        <tr><td>Zelda: TOTK</td><td>22</td><td>35</td><td>44</td><td>46</td><td>-</td><td>-</td><td>Untested</td></tr>
                        <tr><td>The Witcher 3</td><td>14</td><td>30</td><td>42</td><td>35</td><td>41</td><td>75</td><td>Untested</td></tr>
                    </tbody>
                </table>
                
                <table class="rr-table hidden" data-mode="switch">
                    <thead>
                        <tr>
                            <th class="sortable" data-col="0">Game</th>
                            <th data-col-index="1"><span class="text-green-400">RP5</span><div class="text-[10px] text-white/40 font-normal mt-1 chipset-label">SD 865</div></th>
                            <th data-col-index="2"><span class="text-yellow-400">RPG2</span><div class="text-[10px] text-white/40 font-normal mt-1 chipset-label">G2 Gen 2</div></th>
                            <th data-col-index="3"><span class="text-blue-400">Odin 2 P</span><div class="text-[10px] text-white/40 font-normal mt-1 chipset-label">8 Gen 2</div></th>
                            <th data-col-index="4"><span class="text-orange-400">Konkr</span><div class="text-[10px] text-white/40 font-normal mt-1 chipset-label">G3 Gen 3</div></th>
                            <th data-col-index="5"><span class="text-pink-400">Fold 7</span><div class="text-[10px] text-white/40 font-normal mt-1 chipset-label">8 Elite</div></th>
                            <th data-col-index="6"><span class="text-purple-400">Odin 3</span><div class="text-[10px] text-white/40 font-normal mt-1 chipset-label">8 Elite</div></th>
                            <th data-col-index="7"><span class="text-cyan-400">Steam Deck</span><div class="text-[10px] text-white/40 font-normal mt-1 chipset-label">AMD APU</div></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>Captain Toad</td><td>45</td><td>75</td><td>80</td><td>155</td><td>75</td><td>160</td><td>Untested</td></tr>
                        <tr><td>Donut County</td><td>38</td><td>80</td><td>76</td><td>156</td><td>75</td><td>85</td><td>Untested</td></tr>
                        <tr><td>FIFA 18</td><td>60</td><td>73</td><td>86</td><td>150</td><td>82</td><td>100</td><td>Untested</td></tr>
                        <tr><td>Golf Story</td><td>126</td><td>126</td><td>175</td><td>185</td><td>180</td><td>240</td><td>Untested</td></tr>
                        <tr><td>Gris</td><td>61</td><td>115</td><td>110</td><td>260</td><td>126</td><td>130</td><td>Untested</td></tr>
                        <tr><td>Pokémon Sword (Battle)</td><td>40</td><td>70</td><td>84</td><td>123</td><td>95</td><td>130</td><td>Untested</td></tr>
                        <tr><td>Pokémon Sword (Open)</td><td>30</td><td>33</td><td>50</td><td>53</td><td>50</td><td>68</td><td>Untested</td></tr>
                        <tr><td>Slay the Spire</td><td>110</td><td>115</td><td>142</td><td>145</td><td>200</td><td>240</td><td>Untested</td></tr>
                        <tr><td>Tennis in the Face</td><td>124</td><td>106</td><td>124</td><td>124</td><td>124</td><td>125</td><td>Untested</td></tr>
                        <tr><td>Zelda: BOTW</td><td>25</td><td>41</td><td>37</td><td>48</td><td>38</td><td>45</td><td>Untested</td></tr>
                        <tr><td>Zelda: Echoes</td><td>38</td><td>35</td><td>58</td><td>55</td><td>-</td><td>82</td><td>Untested</td></tr>
                        <tr><td>Zelda: TOTK</td><td>22</td><td>35</td><td>44</td><td>46</td><td>-</td><td>-</td><td>Untested</td></tr>
                        <tr><td>The Witcher 3</td><td>14</td><td>30</td><td>42</td><td>35</td><td>41</td><td>75</td><td>Untested</td></tr>
                    </tbody>
                </table>

                <table class="rr-table hidden" data-mode="windows">
                    <thead>
                        <tr>
                            <th class="sortable" data-col="0">Game</th>
                            <th data-col-index="1"><span class="text-green-400">RP5</span><div class="text-[10px] text-white/40 font-normal mt-1 chipset-label">SD 865</div></th>
                            <th data-col-index="2"><span class="text-yellow-400">RPG2</span><div class="text-[10px] text-white/40 font-normal mt-1 chipset-label">G2 Gen 2</div></th>
                            <th data-col-index="3"><span class="text-blue-400">Odin 2 P</span><div class="text-[10px] text-white/40 font-normal mt-1 chipset-label">8 Gen 2</div></th>
                            <th data-col-index="4"><span class="text-orange-400">Konkr</span><div class="text-[10px] text-white/40 font-normal mt-1 chipset-label">G3 Gen 3</div></th>
                            <th data-col-index="5"><span class="text-pink-400">Fold 7</span><div class="text-[10px] text-white/40 font-normal mt-1 chipset-label">8 Elite</div></th>
                            <th data-col-index="6"><span class="text-purple-400">Odin 3</span><div class="text-[10px] text-white/40 font-normal mt-1 chipset-label">8 Elite</div></th>
                            <th data-col-index="7"><span class="text-cyan-400">Steam Deck</span><div class="text-[10px] text-white/40 font-normal mt-1 chipset-label">AMD APU</div></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>Cuphead</td><td>130</td><td>175</td><td>-</td><td>280</td><td>140</td><td>318</td><td>60</td></tr>
                        <tr><td>Cyberpunk 2077</td><td>-</td><td>11</td><td>15</td><td>16</td><td>7</td><td>14</td><td>30</td></tr>
                        <tr><td>Elden Ring</td><td>11</td><td>15</td><td>19</td><td>25</td><td>5</td><td>30</td><td>40</td></tr>
                        <tr><td>GTA V</td><td>20</td><td>44</td><td>47</td><td>57</td><td>-</td><td>67</td><td>76</td></tr>
                        <tr><td>Hades 2</td><td>51</td><td>67</td><td>-</td><td>124</td><td>105</td><td>190</td><td>150</td></tr>
                        <tr><td>Hollow Knight Silksong</td><td>80</td><td>120</td><td>-</td><td>190</td><td>122</td><td>220</td><td>250</td></tr>
                        <tr><td>Megabonk</td><td>-</td><td>40</td><td>-</td><td>68</td><td>40</td><td>90</td><td>240</td></tr>
                        <tr><td>Monster Boy</td><td>115</td><td>100</td><td>160</td><td>165</td><td>120</td><td>220</td><td>250</td></tr>
                        <tr><td>Need for Speed Rivals</td><td>-</td><td>30</td><td>30</td><td>30</td><td>30</td><td>30</td><td>30</td></tr>
                        <tr><td>Skyrim</td><td>25</td><td>36</td><td>57</td><td>57</td><td>47</td><td>57</td><td>60</td></tr>
                        <tr><td>Tomb Raider</td><td>-</td><td>-</td><td>-</td><td>-</td><td>87</td><td>-</td><td>148</td></tr>
                        <tr><td>Traveller’s Rest</td><td>-</td><td>40</td><td>30</td><td>50</td><td>40</td><td>70</td><td>78</td></tr>
                    </tbody>
                </table>

            </div>

            <div class="bg-black/40 p-4 border-t border-white/10 flex flex-col md:flex-row justify-between items-center gap-4 text-xs font-mono text-white/50">
                <div class="flex items-center gap-3">
                    <span>RANKING:</span>
                    <div class="flex items-center gap-1"><span class="w-3 h-3 rounded-sm bg-red-500"></span> Low</div>
                    <div class="flex items-center gap-1"><span class="w-3 h-3 rounded-sm bg-yellow-400"></span> Mid</div>
                    <div class="flex items-center gap-1"><span class="w-3 h-3 rounded-sm bg-green-400"></span> High</div>
                </div>
                <div>Values represent Average FPS estimates.</div>
            </div>
        </div>

        <div class="mt-8 text-center" data-aos="fade-up">
            <button id="toggleNotes" class="bg-white/5 hover:bg-white/10 border border-white/10 text-white px-6 py-3 rounded-xl font-retro text-xs transition-all">
                <i data-lucide="info" class="inline w-4 h-4 mr-2"></i> SHOW NOTES
            </button>
            
            <div id="notesContent" class="hidden mt-6 bento-card p-8 text-left max-w-4xl mx-auto">
                 <div class="grid md:grid-cols-2 gap-8 mb-8">
                     <div>
                         <h3 class="font-retro text-yellow-400 text-sm mb-2 flex items-center gap-2"><i data-lucide="eye" class="w-4 h-4"></i> Performance Measurement</h3>
                         <p class="text-white/60 text-sm leading-relaxed">
                            Please note that these tests utilize "eyeballed" FPS averages observed during active gameplay. They were not captured using scientific frame-time analysis tools or specialized benchmarking software. These values should be viewed as rough guidelines and performance estimates rather than precise scientific measurements.
                         </p>
                     </div>
                     <div>
                        <h3 class="font-retro text-green-400 text-sm mb-2 flex items-center gap-2"><i data-lucide="dollar-sign" class="w-4 h-4"></i> Value Mode</h3>
                        <p class="text-white/60 text-sm leading-relaxed">
                            Value Mode displays the "Price per Frame" for each device. This is calculated by taking the cost of the handheld at the time of filming and dividing it by the average FPS achieved in that specific game ($/FPS). Lower values indicate better cost-to-performance efficiency.
                        </p>
                     </div>
                     <div>
                        <h3 class="font-retro text-blue-400 text-sm mb-2 flex items-center gap-2"><i data-lucide="check-circle" class="w-4 h-4"></i> Runs Great</h3>
                        <p class="text-white/60 text-sm leading-relaxed">
                            The "Runs Great" highlight indicates that the handheld achieved the expected playable target for that title. This threshold is typically 30 FPS for demanding AAA/3D games and 60 FPS for lighter or 2D titles.
                        </p>
                     </div>
                 </div>
                 
                 <div class="mt-8 pt-8 border-t border-white/10">
                     <h3 class="font-retro text-purple-400 text-sm mb-4">Device Specs & Pricing (Time of Filming)</h3>
                     <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 text-xs">
                         <div class="bg-white/5 p-4 rounded-xl border border-white/5 hover:bg-white/10 transition-colors">
                             <span class="text-green-400 font-bold block mb-1 text-sm">Retroid Pocket 5 ($199)</span>
                             <div class="text-white/60 flex flex-col gap-1">
                                <span><span class="text-white/30">Chip:</span> Snapdragon 865</span>
                                <span><span class="text-white/30">RAM:</span> 8GB</span>
                                <span><span class="text-white/30">Storage:</span> 128GB</span>
                             </div>
                         </div>
                         <div class="bg-white/5 p-4 rounded-xl border border-white/5 hover:bg-white/10 transition-colors">
                             <span class="text-yellow-400 font-bold block mb-1 text-sm">Retroid Pocket G2 ($219)</span>
                             <div class="text-white/60 flex flex-col gap-1">
                                <span><span class="text-white/30">Chip:</span> Snapdragon G2 Gen 2</span>
                                <span><span class="text-white/30">RAM:</span> 8GB</span>
                                <span><span class="text-white/30">Storage:</span> 128GB</span>
                             </div>
                         </div>
                         <div class="bg-white/5 p-4 rounded-xl border border-white/5 hover:bg-white/10 transition-colors">
                             <span class="text-blue-400 font-bold block mb-1 text-sm">AYN Odin 2 Portal ($329)</span>
                             <div class="text-white/60 flex flex-col gap-1">
                                <span><span class="text-white/30">Chip:</span> Snapdragon 8 Gen 2</span>
                                <span><span class="text-white/30">RAM:</span> 8GB</span>
                                <span><span class="text-white/30">Storage:</span> 128GB</span>
                             </div>
                         </div>
                         <div class="bg-white/5 p-4 rounded-xl border border-white/5 hover:bg-white/10 transition-colors">
                             <span class="text-orange-400 font-bold block mb-1 text-sm">Konkr Pocket Fit ($329)</span>
                             <div class="text-white/60 flex flex-col gap-1">
                                <span><span class="text-white/30">Chip:</span> Snapdragon G3 Gen 3</span>
                                <span><span class="text-white/30">RAM:</span> 12GB</span>
                                <span><span class="text-white/30">Storage:</span> 256GB</span>
                             </div>
                         </div>
                         <div class="bg-white/5 p-4 rounded-xl border border-white/5 hover:bg-white/10 transition-colors">
                             <span class="text-pink-400 font-bold block mb-1 text-sm">Samsung Fold 7 ($1719)</span>
                             <div class="text-white/60 flex flex-col gap-1">
                                <span><span class="text-white/30">Chip:</span> Snapdragon 8 Elite</span>
                                <span><span class="text-white/30">RAM:</span> 12GB</span>
                                <span><span class="text-white/30">Storage:</span> 512GB</span>
                             </div>
                         </div>
                         <div class="bg-white/5 p-4 rounded-xl border border-white/5 hover:bg-white/10 transition-colors">
                             <span class="text-purple-400 font-bold block mb-1 text-sm">AYN Odin 3 ($449)</span>
                             <div class="text-white/60 flex flex-col gap-1">
                                <span><span class="text-white/30">Chip:</span> Snapdragon 8 Elite</span>
                                <span><span class="text-white/30">RAM:</span> 16GB</span>
                                <span><span class="text-white/30">Storage:</span> 512GB</span>
                             </div>
                         </div>
                         <div class="bg-white/5 p-4 rounded-xl border border-white/5 hover:bg-white/10 transition-colors">
                             <span class="text-cyan-400 font-bold block mb-1 text-sm">Steam Deck ($399)</span>
                             <div class="text-white/60 flex flex-col gap-1">
                                <span><span class="text-white/30">Chip:</span> AMD Custom APU</span>
                                <span><span class="text-white/30">RAM:</span> 16GB</span>
                                <span><span class="text-white/30">Storage:</span> 512GB</span>
                             </div>
                         </div>
                     </div>
                 </div>
            </div>
        </div>

    </main>
    
    <div id="game-details-modal" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" id="game-modal-bg"></div>
        <div id="game-card-wrapper" class="relative bg-[#3D255D] border-2 border-white/20 rounded-3xl w-full max-w-2xl shadow-2xl animate-popIn flex flex-col max-h-[90vh] overflow-hidden">
            <div class="flex justify-between items-center p-4 border-b border-white/10 bg-black/20 shrink-0">
                <span class="font-retro text-white/50 text-sm pl-2">BENCHMARK DETAILS</span>
                <div class="flex gap-2">
                    <button id="screenshot-game-modal" class="text-white/70 hover:text-white hover:bg-white/10 p-2 rounded-lg transition-colors flex items-center gap-2" title="Save Card">
                        <i data-lucide="camera" class="w-5 h-5"></i>
                        <span class="font-bold text-xs hidden sm:inline">SAVE</span>
                    </button>
                    <button id="close-game-modal" class="text-white/70 hover:text-white hover:bg-red-500/20 p-2 rounded-lg transition-colors">
                        <i data-lucide="x" class="w-5 h-5"></i>
                    </button>
                </div>
            </div>
            <div id="game-modal-content" class="overflow-y-auto custom-scrollbar p-6 md:p-8 grow">
                </div>
        </div>
    </div>

    <footer class="bg-black/20 py-10 text-center border-t border-white/5 mt-auto">
        <div class="flex justify-center flex-wrap gap-4 mb-6">
            <a href="https://www.youtube.com/@RyanRetro" target="_blank" class="text-white/40 hover:text-[#fbbf24] transition-colors bg-white/5 p-2 rounded-full hover:bg-white/10" title="YouTube"><i data-lucide="youtube" class="w-5 h-5"></i></a>
            <a href="https://x.com/RyanRetroYT" target="_blank" class="text-white/40 hover:text-[#fbbf24] transition-colors bg-white/5 p-2 rounded-full hover:bg-white/10" title="X (Twitter)"><svg viewBox="0 0 24 24" class="w-5 h-5 fill-current"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg></a>
            <a href="https://www.instagram.com/ryanretroyoutube/" target="_blank" class="text-white/40 hover:text-[#fbbf24] transition-colors bg-white/5 p-2 rounded-full hover:bg-white/10" title="Instagram"><i data-lucide="instagram" class="w-5 h-5"></i></a>
            <a href="https://www.tiktok.com/@ryanretroyoutube" target="_blank" class="text-white/40 hover:text-[#fbbf24] transition-colors bg-white/5 p-2 rounded-full hover:bg-white/10" title="TikTok"><svg viewBox="0 0 24 24" class="w-5 h-5 fill-current"><path d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"/></svg></a>
            <a href="https://discord.gg/RAenS43UV9" target="_blank" class="text-white/40 hover:text-[#fbbf24] transition-colors bg-white/5 p-2 rounded-full hover:bg-white/10" title="Discord"><i data-lucide="message-circle" class="w-5 h-5"></i></a>
            <a href="https://www.facebook.com/RyanRetroYT" target="_blank" class="text-white/40 hover:text-[#fbbf24] transition-colors bg-white/5 p-2 rounded-full hover:bg-white/10" title="Facebook"><i data-lucide="facebook" class="w-5 h-5"></i></a>
            <a href="https://www.threads.com/@ryanretroyoutube" target="_blank" class="text-white/40 hover:text-[#fbbf24] transition-colors bg-white/5 p-2 rounded-full hover:bg-white/10" title="Threads"><i data-lucide="at-sign" class="w-5 h-5"></i></a>
        </div>
        <p class="text-xs font-bold text-white/20 uppercase tracking-widest">Ryan Retro • 2026</p>
    </footer>

    <script>
        lucide.createIcons();
        AOS.init({ once: true, offset: 50, duration: 800 });

        // --- BENCHMARK LOGIC ---
        const DEVICE_COUNT = 7;
        const prices = {
            1: 199,  // RP5
            2: 219,  // RPG2
            3: 329,  // Odin 2 Portal
            4: 329,  // Konkr
            5: 1719, // Fold 7
            6: 449,  // Odin 3
            7: 399   // Steam Deck
        };
        const deviceNames = {
            1: "Retroid Pocket 5",
            2: "Retroid Pocket G2",
            3: "AYN Odin 2 Portal",
            4: "Konkr Pocket Fit",
            5: "Samsung Fold 7",
            6: "AYN Odin 3",
            7: "Steam Deck"
        };
        const deviceColors = {
            1: "text-green-400",
            2: "text-yellow-400",
            3: "text-blue-400",
            4: "text-orange-400",
            5: "text-pink-400",
            6: "text-purple-400",
            7: "text-cyan-400"
        };

        let activeMode = 'combined';
        let highlightOn = false;
        let colorModeOn = false;
        let valueModeOn = false;
        let runsGreatOn = false;
        let miniModeOn = false;
        const columnVisibility = { 1: true, 2: true, 3: true, 4: true, 5: false, 6: true, 7: true };

        const tables = document.querySelectorAll('.rr-table');
        const benchCard = document.getElementById('benchCard');
        const controlsPanel = document.getElementById('controlsPanel');

        function getActiveTable() {
            return document.querySelector(`.rr-table[data-mode="${activeMode}"]`);
        }

        function updateTableVisibility() {
            tables.forEach(t => t.classList.add('hidden'));
            getActiveTable().classList.remove('hidden');
        }

        function clearEffects() {
            document.querySelectorAll('.best-cell').forEach(el => el.classList.remove('best-cell'));
            document.querySelectorAll('.runs-great').forEach(el => el.classList.remove('runs-great'));
            document.querySelectorAll('.rr-table td').forEach(el => {
                el.style.color = '';
                el.style.fontWeight = '';
                if (el.dataset.original) {
                    el.innerHTML = el.dataset.original; 
                    delete el.dataset.original;
                }
            });
        }

        function updateColumnVisibility() {
            tables.forEach(table => {
                const headRow = table.querySelector('thead tr');
                const bodyRows = table.querySelectorAll('tbody tr');

                // Headers
                for (let i = 1; i <= DEVICE_COUNT; i++) {
                    const th = headRow.querySelector(`th[data-col-index="${i}"]`);
                    if (th) th.style.display = columnVisibility[i] ? '' : 'none';
                }

                // Cells
                bodyRows.forEach(row => {
                    const cells = row.children;
                    for (let i = 1; i <= DEVICE_COUNT; i++) {
                        if (cells[i]) cells[i].style.display = columnVisibility[i] ? '' : 'none';
                    }
                });
            });

            if (highlightOn) applyHighlight();
            if (colorModeOn) applyColorMode();
            if (valueModeOn) applyValueMode();
            if (runsGreatOn) applyRunsGreat();
        }

        function applyHighlight() {
            clearEffects();
            const table = getActiveTable();
            const rows = table.querySelectorAll('tbody tr');

            rows.forEach(row => {
                let maxVal = -Infinity;
                let cells = [];

                for (let i = 1; i <= DEVICE_COUNT; i++) {
                    if (!columnVisibility[i]) continue;
                    const cell = row.children[i];
                    if(!cell) continue;
                    const val = parseFloat(cell.innerText);
                    if (!isNaN(val)) {
                        if (val > maxVal) maxVal = val;
                        cells.push(cell);
                    }
                }

                if (maxVal > 0) {
                    cells.forEach(cell => {
                        if (parseFloat(cell.innerText) === maxVal) {
                            cell.classList.add('best-cell');
                        }
                    });
                }
            });
        }

        function applyColorMode() {
            clearEffects();
            const table = getActiveTable();
            const rows = table.querySelectorAll('tbody tr');

            rows.forEach(row => {
                let vals = [];
                for (let i = 1; i <= DEVICE_COUNT; i++) {
                    if (!columnVisibility[i]) continue;
                    const cell = row.children[i];
                    if(!cell) continue;
                    const val = parseFloat(cell.innerText);
                    if (!isNaN(val)) vals.push(val);
                }

                if (vals.length === 0) return;
                const min = Math.min(...vals);
                const max = Math.max(...vals);
                const range = max - min || 1;

                for (let i = 1; i <= DEVICE_COUNT; i++) {
                    if (!columnVisibility[i]) continue;
                    const cell = row.children[i];
                    if(!cell) continue;
                    const val = parseFloat(cell.innerText);
                    if (isNaN(val)) continue;

                    const t = (val - min) / range;
                    if (t < 0.33) {
                        cell.style.color = '#f87171'; // Red
                    } else if (t < 0.66) {
                        cell.style.color = '#facc15'; // Yellow
                    } else {
                        cell.style.color = '#4ade80'; // Green
                        cell.style.fontWeight = 'bold';
                    }
                }
            });
        }

        function applyValueMode() {
            clearEffects();
            const table = getActiveTable();
            const rows = table.querySelectorAll('tbody tr');

            rows.forEach(row => {
                let minCost = Infinity;
                let calculatedCosts = {};

                for (let i = 1; i <= DEVICE_COUNT; i++) {
                    if (!columnVisibility[i]) continue;
                    const cell = row.children[i];
                    if(!cell) continue;

                    if (!cell.dataset.original) {
                        cell.dataset.original = cell.innerText.trim();
                    }
                    
                    const val = parseFloat(cell.dataset.original);
                    if (!isNaN(val) && val > 0) {
                        const cost = prices[i] / val;
                        calculatedCosts[i] = cost;
                        if (cost < minCost) minCost = cost;
                    }
                }

                for (let i = 1; i <= DEVICE_COUNT; i++) {
                    if (!columnVisibility[i]) continue;
                    const cell = row.children[i];
                    if(!cell) continue;

                    const val = parseFloat(cell.dataset.original);
                    if (!isNaN(val) && val > 0) {
                        const cost = prices[i] / val;
                        const isBest = (Math.abs(cost - minCost) < 0.0001);
                        
                        if (isBest) {
                            cell.innerHTML = `<span class="text-green-400 font-bold">$${cost.toFixed(2)}</span>`;
                            cell.classList.add('best-cell');
                        } else {
                            cell.innerHTML = `<span class="text-yellow-400">$${cost.toFixed(2)}</span>`;
                        }
                    }
                }
            });
        }

        function applyRunsGreat() {
            clearEffects();
            const table = getActiveTable();
            const rows = table.querySelectorAll('tbody tr');

            rows.forEach(row => {
                const nameCell = row.children[0];
                const gameName = nameCell.innerText.trim();
                
                const demanding = [
                    'Elden Ring','Cyberpunk 2077','Need for Speed Rivals',
                    'Pokémon Sword (Open)','Pokémon Sword (Battle)',
                    'Zelda: BOTW','Zelda: TOTK','The Witcher 3'
                ].includes(gameName);
                
                const threshold = demanding ? 30 : 60;

                for (let i = 1; i <= DEVICE_COUNT; i++) {
                    if (!columnVisibility[i]) continue;
                    const cell = row.children[i];
                    if(!cell) continue;
                    const val = parseFloat(cell.innerText);
                    if (!isNaN(val) && val >= threshold) {
                        cell.classList.add('runs-great');
                    }
                }
            });
        }

        // --- HANDLERS ---
        
        // Modes
        document.querySelectorAll('.mode-toggle').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.mode-toggle').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                activeMode = btn.dataset.mode;
                
                // Update Control Panel Style
                controlsPanel.classList.remove('panel-yellow', 'panel-red', 'panel-blue');
                if (activeMode === 'combined') controlsPanel.classList.add('panel-yellow');
                else if (activeMode === 'switch') controlsPanel.classList.add('panel-red');
                else if (activeMode === 'windows') controlsPanel.classList.add('panel-blue');

                updateTableVisibility();
                
                // Re-apply current feature
                if (highlightOn) applyHighlight();
                if (colorModeOn) applyColorMode();
                if (valueModeOn) applyValueMode();
                if (runsGreatOn) applyRunsGreat();
            });
        });

        // Device Toggles
        document.querySelectorAll('.device-toggle').forEach(btn => {
            btn.addEventListener('click', () => {
                const idx = parseInt(btn.dataset.colIndex);
                if (btn.classList.contains('active')) {
                    btn.classList.remove('active');
                    btn.classList.add('off');
                    columnVisibility[idx] = false;
                } else {
                    btn.classList.remove('off');
                    btn.classList.add('active');
                    columnVisibility[idx] = true;
                }
                updateColumnVisibility();
            });
        });

        // Feature Toggles (Radio behavior)
        const feats = ['highlight', 'ranking', 'value', 'great'];
        feats.forEach(f => {
            document.querySelector(`.feat-${f}`).addEventListener('click', (e) => {
                const btn = e.target.closest('button');
                const wasActive = btn.classList.contains('active');
                
                // Reset all
                feats.forEach(x => {
                    document.querySelector(`.feat-${x}`).classList.remove('active');
                    if(x === 'highlight') highlightOn = false;
                    if(x === 'ranking') colorModeOn = false;
                    if(x === 'value') valueModeOn = false;
                    if(x === 'great') runsGreatOn = false;
                });
                
                clearEffects();
                
                if (!wasActive) {
                    btn.classList.add('active');
                    if(f === 'highlight') { highlightOn = true; applyHighlight(); }
                    if(f === 'ranking') { colorModeOn = true; applyColorMode(); }
                    if(f === 'value') { valueModeOn = true; applyValueMode(); }
                    if(f === 'great') { runsGreatOn = true; applyRunsGreat(); }
                }
            });
        });

        // Mini Mode Toggle
        document.getElementById('toggleMiniMode').addEventListener('click', function() {
            this.classList.toggle('active');
            miniModeOn = !miniModeOn;
            if(miniModeOn) benchCard.classList.add('mini-mode');
            else benchCard.classList.remove('mini-mode');
        });

        // Notes Toggle
        document.getElementById('toggleNotes').addEventListener('click', () => {
            document.getElementById('notesContent').classList.toggle('hidden');
        });

        // Mobile Menu
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        if(mobileMenuBtn) {
            mobileMenuBtn.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });
        }
        
        // Sorting Logic
        document.querySelectorAll('th.sortable').forEach(th => {
            th.addEventListener('click', function() {
                const table = th.closest('table');
                const tbody = table.querySelector('tbody');
                const rowsArray = Array.from(tbody.rows);
                const colIndex = Array.from(th.parentNode.children).indexOf(th);
                const isAsc = th.dataset.sortDir === 'asc';
                
                table.querySelectorAll('th').forEach(h => h.removeAttribute('data-sort-dir'));
                th.dataset.sortDir = isAsc ? 'desc' : 'asc';
                
                rowsArray.sort((a, b) => {
                    const cellA = a.children[colIndex];
                    const cellB = b.children[colIndex];
                    
                    const getCleanVal = (cell) => {
                        let val = cell.innerText.trim();
                        if (val.startsWith('$')) val = val.substring(1);
                        if (val === '-' || val.toLowerCase() === 'untested') return -1;
                        const n = parseFloat(val);
                        return isNaN(n) ? val : n;
                    };

                    const valA = getCleanVal(cellA);
                    const valB = getCleanVal(cellB);

                    if (typeof valA === 'number' && typeof valB === 'number') {
                        return isAsc ? valB - valA : valA - valB;
                    } else {
                        return isAsc ? valB.toString().localeCompare(valA) : valA.toString().localeCompare(valB);
                    }
                });
                tbody.append(...rowsArray);
            });
        });

        // --- GAME MODAL LOGIC ---
        
        const modal = document.getElementById('game-details-modal');
        const modalContent = document.getElementById('game-modal-content');
        const closeBtn = document.getElementById('close-game-modal');
        const bg = document.getElementById('game-modal-bg');

        // Add Click listeners to all rows
        function attachRowListeners() {
            document.querySelectorAll('.rr-table tbody tr').forEach(row => {
                row.addEventListener('click', () => openBenchmarkModal(row));
            });
        }

        function openBenchmarkModal(row) {
            // 1. Get exact Game Name
            const gameName = row.children[0].innerText.trim();

            // 2. HARDCODED "SOURCE OF TRUTH"
            // This dictionary maps your specific table names to exact 600x900 (vertical) images.
            // No searching. No guessing. 100% accuracy.
            const GAME_COVERS = {
  // --- Nintendo / Exclusives ---
  "Captain Toad: Treasure Tracker":
    "https://assets.nintendo.com/image/upload/ar_2:3,c_pad,dpr_2.0,f_auto,q_auto,w_400/b_white/ncom/en_US/games/switch/c/captain-toad-treasure-tracker-switch/hero",
  "Golf Story":
    "https://assets.nintendo.com/image/upload/ar_2:3,c_pad,dpr_2.0,f_auto,q_auto,w_400/b_white/ncom/en_US/games/switch/g/golf-story-switch/hero",
  "Pokémon Sword (Battle)":
    "https://assets.nintendo.com/image/upload/ar_2:3,c_pad,dpr_2.0,f_auto,q_auto,w_400/b_white/ncom/en_US/games/switch/p/pokemon-sword-switch/hero",
  "Pokémon Sword (Open)":
    "https://assets.nintendo.com/image/upload/ar_2:3,c_pad,dpr_2.0,f_auto,q_auto,w_400/b_white/ncom/en_US/games/switch/p/pokemon-sword-switch/hero",
  "Zelda: BOTW":
    "https://assets.nintendo.com/image/upload/ar_2:3,c_pad,dpr_2.0,f_auto,q_auto,w_400/b_white/ncom/en_US/games/switch/t/the-legend-of-zelda-breath-of-the-wild-switch/hero",
  "Zelda: TOTK":
    "https://assets.nintendo.com/image/upload/ar_2:3,c_pad,dpr_2.0,f_auto,q_auto,w_400/b_white/ncom/en_US/games/switch/t/the-legend-of-zelda-tears-of-the-kingdom-switch/hero",

  // FIX: your Nintendo "Echoes" slug is often the one that breaks.
  // This one is a direct, hotlinkable cover image.
  "Zelda: Echoes":
    "https://static.honestgamers.com/images/games/19/84/17/17189/5.jpg", // :contentReference[oaicite:1]{index=1}

  // --- Steam / Multiplatform (Using Steam Library Vertical Art) ---
  "Cuphead":
    "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/268910/library_600x900.jpg",
  "Cyberpunk 2077":
    "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/1091500/library_600x900.jpg",
  "Donut County":
    "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/702670/library_600x900.jpg",
  "Elden Ring":
    "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/1245620/library_600x900.jpg",

  // FIX: use the actual full-size Wikipedia file (not a random thumbnail).
  "FIFA 18":
    "https://upload.wikimedia.org/wikipedia/en/d/d4/FIFA18cover.png", // :contentReference[oaicite:2]{index=2}

  "Gris":
    "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/683320/library_600x900.jpg",
  "GTA V":
    "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/271590/library_600x900.jpg",
  "Hades 2":
    "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/1145350/library_600x900.jpg",
  "Hollow Knight Silksong":
    "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/1030300/library_600x900.jpg",
  "Monster Boy":
    "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/449610/library_600x900.jpg",
  "Need for Speed Rivals":
    "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/1262600/library_600x900.jpg",
  "Skyrim":
    "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/489830/library_600x900.jpg",
  "Slay the Spire":
    "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/646570/library_600x900.jpg",

  // FIX: 394290 does NOT have library_600x900.jpg, but it DOES have a portrait asset.
  "Tennis in the Face":
    "https://prod-images.blacknut.net/65fae0a22227219ef319e43d_sm.jpg", // :contentReference[oaicite:3]{index=3}

  "Tomb Raider":
    "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/203160/library_600x900.jpg",
  "Traveller’s Rest":
    "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/1139980/library_600x900.jpg",
  "The Witcher 3":
    "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/292030/library_600x900.jpg",

  // --- Niche / manual fallbacks ---
  "Megabonk":
    "https://placehold.co/600x900/4c1d95/ffffff?text=MEGABONK",
};


            // 3. Select Art
            let boxArtUrl = GAME_COVERS[gameName];

            // 4. Fail-safe (Only searches if you add a new game and forget to update the list above)
            if (!boxArtUrl) {
                console.warn("Missing explicit cover for:", gameName);
                const suffix = " Box Art"; 
                boxArtUrl = `https://tse2.mm.bing.net/th?q=${encodeURIComponent(gameName + suffix)}&w=300&h=450&c=7&rs=1&p=0`;
            }

            const initials = gameName.split(' ').map(n=>n[0]).join('').substring(0,2).toUpperCase();
            const fallbackArt = `https://placehold.co/300x450/211136/FFF?text=${initials}`;

            // 5. Build Results HTML (Standard Logic)
            let resultsHtml = '';
            for(let i=1; i<=DEVICE_COUNT; i++) {
                if(!columnVisibility[i]) continue;
                
                const cell = row.children[i];
                if(!cell) continue;
                
                let val = cell.innerText.trim();
                if(cell.dataset.original) val = cell.dataset.original;
                
                const deviceName = deviceNames[i];
                const colorClass = deviceColors[i];
                
                resultsHtml += `
                    <div class="flex justify-between items-center p-3 bg-white/5 rounded-lg border border-white/5">
                        <span class="font-bold text-sm ${colorClass}">${deviceName}</span>
                        <span class="font-body font-bold text-white text-lg">${val} <span class="text-xs text-white/30 font-normal">FPS</span></span>
                    </div>
                `;
            }

            // 6. Populate Modal
            modalContent.innerHTML = `
                <div class="flex flex-col md:flex-row gap-6">
                    <div class="w-full md:w-1/3">
                        <div class="rounded-xl overflow-hidden shadow-2xl border-2 border-white/10 aspect-[2/3] bg-black/50 relative group">
                            <img src="${boxArtUrl}" crossorigin="anonymous" class="w-full h-full object-cover" onerror="this.src='${fallbackArt}'">
                            <div class="absolute inset-0 bg-gradient-to-t from-[#1a0b2e] to-transparent opacity-60"></div>
                        </div>
                    </div>
                    <div class="w-full md:w-2/3 flex flex-col">
                        <h2 class="font-display font-black text-3xl text-white mb-1 leading-tight">${gameName}</h2>
                        <span class="text-white/40 text-xs font-bold uppercase tracking-widest mb-6">Benchmark Results</span>
                        
                        <div class="grid grid-cols-1 gap-2 overflow-y-auto max-h-[400px] pr-2 custom-scrollbar">
                            ${resultsHtml}
                        </div>
                    </div>
                </div>
            `;

            modal.classList.remove('hidden');
        }

        // Close Modal
        const closeModal = () => modal.classList.add('hidden');
        closeBtn.addEventListener('click', closeModal);
        bg.addEventListener('click', closeModal);

        // Screenshot Feature (Bonus)
        document.getElementById('screenshot-game-modal').addEventListener('click', function() {
            const btn = this;
            const originalIcon = btn.innerHTML;
            btn.innerHTML = `<i data-lucide="loader" class="w-5 h-5 animate-spin"></i>`;
            lucide.createIcons();

            // Create temporary container for capture (like in handheld.html)
            const captureContainer = document.createElement('div');
            Object.assign(captureContainer.style, {
                position: 'fixed',
                top: '-9999px',
                left: '-9999px',
                width: '800px', // Fixed width for consistent capture
                backgroundColor: '#1a0b2e', // Solid deep purple background
                backgroundImage: 'radial-gradient(circle at top center, #3b0764, #1a0b2e)',
                padding: '40px',
                borderRadius: '20px',
                zIndex: '-1'
            });

            // Reconstruct content for capture with solid styles
            const content = document.getElementById('game-modal-content').innerHTML;
            captureContainer.innerHTML = `
                <div class="relative bg-[#3D255D] border-2 border-white/20 rounded-3xl p-8 shadow-2xl flex flex-col text-white font-sans">
                    ${content}
                    <div class="mt-8 pt-4 border-t border-white/10 flex justify-between items-center">
                        <div class="flex items-center gap-2">
                            <span class="font-display font-bold text-xl tracking-tight">Ryan Retro</span>
                        </div>
                        <span class="font-mono text-white/50 text-xs">ryanretro.com</span>
                    </div>
                </div>
            `;
            document.body.appendChild(captureContainer);

            html2canvas(captureContainer, {
                backgroundColor: '#1a0b2e',
                scale: 2,
                useCORS: true,
                allowTaint: true,
                logging: false,
                width: 800,
                windowWidth: 800
            }).then(canvas => {
                document.body.removeChild(captureContainer);
                const link = document.createElement('a');
                link.download = 'RyanRetro-Benchmark.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
                btn.innerHTML = originalIcon;
                lucide.createIcons();
            }).catch(err => {
                console.error("Capture failed:", err);
                document.body.removeChild(captureContainer);
                btn.innerHTML = originalIcon;
                lucide.createIcons();
                alert("Capture failed. Try again.");
            });
        });

        // Init visibility & listeners
        attachRowListeners();
        updateTableVisibility();
        updateColumnVisibility();

    </script>
</body>
</html>
