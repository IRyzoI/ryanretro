<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ryan Retro Shop - Best Deals & Gear</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Roboto:wght@400;700&display=swap');
        .retro-font { font-family: 'Press Start 2P', cursive; }
        .pixel-border { border: 4px solid #000; box-shadow: 8px 8px 0 rgba(0,0,0,0.2); }
        .pixel-btn { transition: all 0.1s ease; }
        .pixel-btn:active { transform: translate(2px, 2px); box-shadow: 2px 2px 0 rgba(0,0,0,0.2); }
        .cheapest-badge { animation: pulse-gold 2s infinite; }
        @keyframes pulse-gold {
            0% { box-shadow: 0 0 0 0 rgba(250, 204, 21, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(250, 204, 21, 0); }
            100% { box-shadow: 0 0 0 0 rgba(250, 204, 21, 0); }
        }
        
        /* Tray Animation */
        #tray { transition: transform 0.3s ease-in-out; }
        .tray-hidden { transform: translateY(100%); }
        .tray-visible { transform: translateY(0); }

        /* --- VIEW MODES CSS --- */
        #productGrid.view-list { grid-template-columns: 1fr !important; }
        #productGrid.view-list .product-card { flex-direction: row; height: auto; min-height: 200px; }
        #productGrid.view-list .card-img-wrapper { width: 280px; height: auto; }
        #productGrid.view-list .card-content { padding: 1.5rem; display: flex; flex-direction: column; justify-content: center; }
        @media (max-width: 768px) {
            #productGrid.view-list .product-card { flex-direction: column; }
            #productGrid.view-list .card-img-wrapper { width: 100%; height: 200px; }
        }

        #productGrid.view-compact {
            display: flex !important;
            flex-direction: column !important;
            gap: 0 !important;
            border: 4px solid #000;
            background: #1f2937;
        }
        
        .compact-row {
            display: flex;
            align-items: center;
            padding: 0.5rem 1rem;
            border-bottom: 1px solid #374151;
            transition: background 0.1s;
            height: 60px;
        }
        .compact-row:hover { background-color: #374151; }
        .compact-row:last-child { border-bottom: none; }

        .c-thumb { width: 40px; height: 40px; border-radius: 4px; object-fit: cover; border: 2px solid #000; }
        .c-info { flex-grow: 1; margin-left: 1rem; display: flex; flex-direction: column; justify-content: center; min-width: 0; }
        .c-title { font-weight: bold; font-size: 0.875rem; color: #fff; line-height: 1.2; }
        .c-cat { font-size: 0.65rem; color: #9ca3af; text-transform: uppercase; margin-top: 2px; }
        
        /* Store Buttons Container */
        .c-stores { display: flex; gap: 8px; margin: 0 1.5rem; }
        .store-icon-btn {
            display: flex; align-items: center; justify-content: center;
            width: 32px; height: 32px;
            border-radius: 4px;
            color: #fff;
            transition: all 0.2s;
            opacity: 0.2; /* Default disabled state */
            pointer-events: none;
            background: #374151;
        }
        .store-icon-btn.active { opacity: 1; pointer-events: auto; }
        .store-icon-btn.active:hover { transform: scale(1.1); }
        
        /* Custom styling for the dropdowns */
        .retro-select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            box-shadow: 4px 4px 0 rgba(0,0,0,0.5);
        }

        .retro-select:focus {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0 rgba(0,0,0,0.5);
        }
        
        /* Scrollbar Hiding */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* Brand Colors */
        .store-brand.active { background: #3B82F6; }
        .store-ali.active { background: #EF4444; }
        .store-amz.active { background: #F59E0B; color: black; }

        .c-price { font-family: 'Press Start 2P', cursive; font-size: 0.65rem; color: #4ade80; margin-right: 1.5rem; width: 80px; text-align: right; }
        .c-actions { display: flex; gap: 0.5rem; align-items: center; border-left: 1px solid #4b5563; padding-left: 1rem; }

        /* Badge Styles */
        .product-card { position: relative; }
        .product-badge {
            position: absolute;
            bottom: 0; right: 0; 
            background-color: #991b1b; 
            color: white;
            padding: 4px 8px; 
            border-top-left-radius: 6px;
            font-family: 'Press Start 2P', cursive; 
            font-size: 0.5rem; 
            line-height: 1.4; 
            box-shadow: -2px -2px 0 rgba(0,0,0,0.3);
            z-index: 20; 
            text-transform: uppercase; 
            border-left: 2px solid white;
            border-top: 2px solid white;
        }

        @media (max-width: 768px) {
            .c-stores { display: none; }
            .c-price { display: none; }
        }
    </style>
</head>
<body class="bg-gray-900 text-white font-sans overflow-x-hidden pb-32">

<header class="bg-gray-800 py-8 border-b-4 border-black">
    <div class="container mx-auto px-4 flex flex-col md:flex-row items-center justify-between">
        <a href="/" class="flex items-center gap-4 mb-4 md:mb-0">
            <img src="https://huggingface.co/spaces/IRyzoI/RyanRetro/resolve/main/images/ryan%20retro%20logo.png" 
                 class="w-16 h-16 rounded-full pixel-border bg-gray-900">
            <h1 class="retro-font text-2xl text-yellow-400">RYAN'S STORE</h1>
        </a>
        <div class="flex gap-4">
            <a href="/" class="pixel-btn bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded retro-font text-xs">
                ‚Üê BACK HOME
            </a>
        </div>
    </div>
</header>

<section class="py-8 container mx-auto px-4">
    <div class="bg-gray-800 p-6 rounded-lg pixel-border flex flex-col gap-6">
        
        <div class="w-full relative">
            <i data-feather="search" class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5"></i>
            <input type="text" id="searchInput" placeholder="SEARCH GEAR..." 
                   class="w-full bg-gray-900 border-4 border-black text-white text-center px-4 py-4 rounded focus:outline-none focus:border-yellow-400 retro-font text-sm uppercase shadow-[4px_4px_0_0_rgba(0,0,0,0.5)]">
        </div>
        
        <div class="w-full flex flex-col xl:flex-row items-center justify-between gap-6 xl:gap-0">
            
            <div class="flex flex-nowrap gap-2 justify-start md:justify-center w-full xl:w-auto overflow-x-auto no-scrollbar" id="filterContainer">
                <button class="filter-btn active bg-yellow-400 text-black px-6 py-3 rounded pixel-btn retro-font text-xs border-2 border-black whitespace-nowrap" data-cat="all">ALL</button>
                <button class="filter-btn bg-gray-700 text-white px-6 py-3 rounded pixel-btn retro-font text-xs border-2 border-black whitespace-nowrap" data-cat="Handhelds">HANDHELDS</button>
                <button class="filter-btn bg-gray-700 text-white px-6 py-3 rounded pixel-btn retro-font text-xs border-2 border-black whitespace-nowrap" data-cat="Accessories">ACCESSORIES</button>
            </div>

            <div class="flex flex-wrap gap-2 w-full md:w-auto justify-center md:justify-end">
    
                <div class="relative w-1/3 md:w-auto">
                    <select id="currencyFilter" class="retro-select appearance-none w-full md:w-32 bg-gray-900 text-yellow-400 font-bold pl-4 pr-10 py-3 rounded pixel-btn retro-font text-[10px] uppercase border-2 border-black cursor-pointer focus:outline-none focus:border-yellow-400">
                        <option value="USD">USD $</option>
                        <option value="EUR">EUR ‚Ç¨</option>
                        <option value="GBP">GBP ¬£</option>
                        <option value="KRW">KRW ‚Ç©</option>
                        <option value="CAD">CAD $</option>
                        <option value="AUD">AUD $</option>
                    </select>
                    <i data-feather="chevron-down" class="absolute right-2 top-3 w-4 h-4 text-gray-400 pointer-events-none"></i>
                </div>

                <div class="relative w-1/3 md:w-auto">
                    <select id="brandFilter" class="retro-select appearance-none w-full md:w-40 bg-gray-900 text-white pl-4 pr-10 py-3 rounded pixel-btn retro-font text-[10px] uppercase border-2 border-black cursor-pointer focus:outline-none focus:border-yellow-400">
                        <option value="all">BRANDS</option>
                    </select>
                    <i data-feather="chevron-down" class="absolute right-2 top-3 w-4 h-4 text-gray-400 pointer-events-none"></i>
                </div>
                
                <div class="relative w-1/3 md:w-auto">
                    <select id="sortFilter" class="retro-select appearance-none w-full md:w-48 bg-gray-900 text-white pl-4 pr-10 py-3 rounded pixel-btn retro-font text-[10px] uppercase border-2 border-black cursor-pointer focus:outline-none focus:border-yellow-400">
                        <option value="default">SORT: NEW</option>
                        <option value="price-asc">PRICE: LOW ‚¨Ü</option>
                        <option value="price-desc">PRICE: HIGH ‚¨á</option>
                    </select>
                    <i data-feather="chevron-down" class="absolute right-2 top-3 w-4 h-4 text-gray-400 pointer-events-none"></i>
                </div>
            </div>

            <div class="flex bg-gray-900 rounded border-4 border-black p-1 shadow-[4px_4px_0_0_rgba(0,0,0,0.5)]">
                <button class="view-btn p-2 hover:bg-gray-700 rounded text-yellow-400" data-view="grid" title="Grid View">
                    <i data-feather="grid" class="w-5 h-5"></i>
                </button>
                <button class="view-btn p-2 hover:bg-gray-700 rounded text-gray-400" data-view="list" title="Card List">
                    <i data-feather="list" class="w-5 h-5"></i>
                </button>
                <button class="view-btn p-2 hover:bg-gray-700 rounded text-gray-400" data-view="compact" title="Compact List">
                    <i data-feather="align-justify" class="w-5 h-5"></i>
                </button>
            </div>
        </div>
    </div>
</section>

<section class="container mx-auto px-4 min-h-[50vh]">
    <div id="productGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 transition-all duration-300">
        <div class="col-span-full text-center text-gray-500 retro-font py-20">Loading Gear...</div>
    </div>
</section>

<template id="productTemplate">
    <div class="product-card bg-gray-800 rounded-lg overflow-hidden pixel-border flex flex-col h-full" data-aos="fade-up">
        <div class="relative h-56 bg-black group card-img-wrapper shrink-0">
            <img src="" alt="" class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105 product-img">
            <div class="in-tray-indicator absolute inset-0 border-4 border-yellow-400 hidden pointer-events-none z-10 bg-yellow-400/10"></div>
        </div>

        <div class="p-6 flex-1 flex flex-col card-content">
            <div class="flex justify-between items-start">
                <h3 class="retro-font text-lg text-white mb-2 leading-tight product-title">Product Name</h3>
            </div>
            
            <p class="text-gray-400 text-sm mb-6 flex-1 product-desc">Description goes here.</p>
            
            <button class="tray-btn w-full mb-4 bg-gray-700 hover:bg-gray-600 text-white py-2 rounded pixel-btn retro-font text-[10px] flex items-center justify-center gap-2 transition-colors">
                <i data-feather="plus" class="w-4 h-4"></i>
                <span class="tray-btn-text">ADD TO TRAY</span>
            </button>

            <div class="space-y-3 product-links"></div>
        </div>
    </div>
</template>

<template id="compactTemplate">
    <div class="compact-row group">
        <img src="" class="c-thumb" alt="Product">
        
        <div class="c-info">
            <div class="c-title truncate pr-2">Product Name</div>
            <div class="c-cat">Category</div>
        </div>

        <div class="c-stores">
            <a href="#" target="_blank" class="store-icon-btn store-brand" title="Official Store">
                <i data-feather="globe" class="w-4 h-4"></i>
            </a>
            <a href="#" target="_blank" class="store-icon-btn store-ali" title="AliExpress">
                <i data-feather="package" class="w-4 h-4"></i>
            </a>
            <a href="#" target="_blank" class="store-icon-btn store-amz" title="Amazon">
                <i data-feather="shopping-cart" class="w-4 h-4"></i>
            </a>
        </div>

        <div class="c-price">$0.00</div>

        <div class="c-actions">
            <button class="c-tray-btn bg-gray-700 hover:bg-yellow-400 hover:text-black text-gray-300 p-2 rounded transition-colors" title="Add to Tray">
                <i data-feather="plus" class="w-4 h-4"></i>
            </button>
        </div>
    </div>
</template>

<div id="tray" class="fixed bottom-0 left-0 right-0 z-50 tray-hidden">
    <div class="bg-black/95 border-t-2 border-yellow-400 shadow-[0_-10px_40px_rgba(0,0,0,0.5)] backdrop-blur-md">
        <div class="container mx-auto px-4 py-3">
            <div class="flex flex-wrap items-center justify-between mb-3 border-b border-gray-700 pb-2 gap-4">
                
                <div class="flex items-center gap-6">
                    <div class="flex items-center gap-2">
                        <div class="retro-font text-xs text-yellow-400">YOUR TRAY</div>
                        <div class="text-xs text-gray-400 bg-gray-800 px-2 py-1 rounded">
                            <span id="trayCount" class="text-white font-bold">0</span> items
                        </div>
                    </div>
                    
                    <div class="flex items-center gap-2">
                        <span class="text-xs text-gray-400 uppercase tracking-wide">Est. Total:</span>
                        <span id="trayTotal" class="retro-font text-sm text-green-400">$0.00</span>
                    </div>
                </div>

                <div class="flex gap-2">
                    <button id="openTrayLinks" class="bg-green-600 hover:bg-green-500 text-white px-3 py-1.5 rounded pixel-btn text-[10px] font-bold flex items-center gap-2">
                        <i data-feather="external-link" class="w-3 h-3"></i> OPEN ALL
                    </button>
                    <button id="clearTray" class="bg-gray-800 hover:bg-red-900 text-gray-300 px-3 py-1.5 rounded pixel-btn text-[10px]">
                        CLEAR
                    </button>
                </div>
            </div>

            <div id="trayItems" class="flex gap-3 overflow-x-auto pb-2" style="scrollbar-width: thin; scrollbar-color: #4b5563 #000000;">
                </div>
        </div>
    </div>
</div>

<footer class="bg-black py-8 mt-20 border-t-4 border-gray-800">
    <div class="container mx-auto text-center text-gray-500 text-xs retro-font">
        <p>Links may be affiliate links. I earn a small commission at no extra cost to you.</p>
        <p class="mt-2">¬© 2025 Ryan Retro</p>
    </div>
</footer>

<script>
    // --- EMBEDDED DATA START ---
    const allProducts = [
      {
        "id": "trimui_brick_hammer",
        "name": "TrimUI Brick Hammer",
        "category": "Handhelds",
        "badge": "Highly Recommended! üèÜ",
        "image": "https://www.trimuistore.com/cdn/shop/files/en_BRICK_HAMMER_CN_61.jpg?v=1761893782&width=1646",
        "description": "The premium metal sensation. CNC aluminum shell with a stunning 3.2\" IPS screen.",
        "links": [
          { "store": "Official", "url": "https://www.trimuistore.com/products/trimui-brick-hammer-handheld-game-console?sca_ref=9846443.gwM5071BNJJv", "price": 94.99, "currency": "$" },
          { "store": "Amazon", "url": "https://amzn.to/3MBZ1qY", "price": 95.99, "currency": "$" },
          { "store": "AliExpress", "url": "#", "price": 115.00, "currency": "$" }
        ]
      },
      {
        "id": "trimui_brick",
        "name": "TrimUI Brick",
        "category": "Handhelds",
        "badge": "Best Value üéÅ",
        "image": "https://www.trimuistore.com/cdn/shop/files/TRIMUI_Brick_Retro_Game_Console_Purple.png?v=1763623253&width=1646",
        "description": "Compact vertical perfection. 1024x768 resolution in a lightweight, colorful package.",
        "links": [
          { "store": "Official", "url": "https://www.trimuistore.com/products/trimui-brick-retro-handheld-game-console?sca_ref=9846443.gwM5071BNJJJv", "price": 84.99, "currency": "$" },
          { "store": "Amazon", "url": "https://amzn.to/4j3t2Mw", "price": 73.00, "currency": "$" },
          { "store": "AliExpress", "url": "#", "price": 75.00, "currency": "$" }
        ]
      },
      {
        "id": "rp6",
        "name": "Retroid Pocket 6",
        "category": "Handhelds",
        "badge": "Pre-order üî•",
        "image": "https://www.goretroid.com/cdn/shop/files/5_768cb886-abd3-4002-9b24-247afa1976f1_1024x1024@2x.jpg?v=1763437686",
        "description": "The new flagship. Snapdragon 8 Gen 2, 5.5\" 1080p 120Hz AMOLED. Available in Ryan Retro Purple!",
        "links": [
          { "store": "Official", "url": "https://www.goretroid.com/collections/retro-game-system/products/retroid-pocket-6-handheld?sca_ref=7339476.fIz7oKv7uT", "price": 209.00, "currency": "$" }
        ]
      },
      {
        "id": "steam_deck",
        "name": "Steam Deck",
        "category": "Handhelds",
        "image": "https://m.media-amazon.com/images/I/516sb3osGJL._SL1231_.jpg",
        "description": "The standard for PC handheld gaming. Play your Steam library on the go.",
        "links": [
          { "store": "Amazon", "url": "https://amzn.to/3XSu5Fe", "price": 469.00, "currency": "$" }
        ]
      },
      {
        "id": "rp5",
        "name": "Retroid Pocket 5",
        "category": "Handhelds",
        "image": "https://huggingface.co/spaces/IRyzoI/RyanRetro/resolve/main/images/rp5square.png",
        "description": "Snapdragon 865 power in a premium 5.5\" OLED shell.",
        "links": [
          { "store": "Official", "url": "https://www.goretroid.com/products/retroid-pocket-5-handheld?sca_ref=7339476.fIz7oKv7uT", "price": 199.00, "currency": "$" },
          { "store": "AliExpress", "url": "https://s.click.aliexpress.com/e/_c4PGUhcl", "price": 204.00, "currency": "$" },
          { "store": "Amazon", "url": "#", "price": 249.00, "currency": "$" }
        ]
      },
      {
        "id": "rp_mini2",
        "name": "Retroid Pocket Mini V2",
        "category": "Handhelds",
        "image": "https://www.goretroid.com/cdn/shop/files/1_0a16ff81-5144-4635-8efb-f1ab541e4a14_1024x1024@2x.jpg?v=1746701824",
        "description": "A compact powerhouse featuring a 3.92\" OLED (1240x1080) and Snapdragon 865.",
        "links": [
          { "store": "Official", "url": "https://www.goretroid.com/products/retroid-pocket-mini-v2-handheld?sca_ref=7339476.fIz7oKv7uT", "price": 179.00, "currency": "$" },
          { "store": "AliExpress", "url": "https://s.click.aliexpress.com/e/_c2viGFHB", "price": 204.00, "currency": "$" },
          { "store": "Amazon", "url": "https://amzn.to/4iXk4jH", "price": 229.00, "currency": "$" }
        ]
      },
      {
        "id": "rp_classic",
        "name": "Retroid Pocket Classic",
        "category": "Handhelds",
        "image": "https://www.goretroid.com/cdn/shop/files/SKU_790b844f-6ba6-4834-8278-9fce3b994d27_1024x1024@2x.png?v=1754461254",
        "description": "Vertical nostalgia meets modern power. Snapdragon G1 Gen 2 with a 4-inch OLED screen.",
        "links": [
          { "store": "Official", "url": "https://www.goretroid.com/products/retroid-pocket-classic?sca_ref=7339476.fIz7oKv7uT", "price": 129.00, "currency": "$" },
          { "store": "AliExpress", "url": "https://www.aliexpress.us/item/3256809185963397.html?pdp_npi=4%40dis%21USD%21US%20%24134.00%21US%20%24134.00%21%21%21134.00%21134.00%21%402151e6dc17657942648816965eb39b%2112000048900137989%21sh%21US%211614690223%21X&spm=a2g0o.store_pc_allItems_or_groupList.new_all_items_2007586173957.1005009372278149&gatewayAdapt=glo2usa", "price": 134.00, "currency": "$" },
          { "store": "Amazon", "url": "https://amzn.to/3KLWx8M", "price": 149.00, "currency": "$" }
        ]
      },
      {
        "id": "rp_flip2",
        "name": "Retroid Pocket Flip 2",
        "category": "Handhelds",
        "image": "https://www.goretroid.com/cdn/shop/files/ice_blue_4b29c9c7-fcc1-4bb4-8a83-f8cf03b9cfd2_1024x1024@2x.jpg?v=1744886442",
        "description": "The clamshell returns. Protect your screen on the go with Snapdragon 865 performance.",
        "links": [
          { "store": "Official", "url": "https://www.goretroid.com/products/retroid-pocket-flip-2?sca_ref=7339476.fIz7oKv7uT", "price": 209.00, "currency": "$" },
          { "store": "AliExpress", "url": "https://s.click.aliexpress.com/e/_c4ovQKfP", "price": 256.80, "currency": "$" },
          { "store": "Amazon", "url": "https://amzn.to/44rQFZ1", "price": 269.00, "currency": "$" }
        ]
      },
      {
        "id": "rpg2",
        "name": "Retroid Pocket G2 Handheld",
        "category": "Handhelds",
        "image": "https://www.goretroid.com/cdn/shop/files/723e012906c411dfa82d5fec119e5474_1024x1024@2x.jpg?v=1762132633",
        "description": "Premium mid-range Android handheld with a 5.5-inch AMOLED screen and Snapdragon G2 Gen 2 power.",
        "links": [
          { "store": "Official", "url": "https://www.goretroid.com/products/retroid-pocket-g2-handheld?sca_ref=7339476.fIz7oKv7uT", "price": 219.00, "currency": "$" },
          { "store": "AliExpress", "url": "https://s.click.aliexpress.com/e/_c3kUZAmH", "price": 224.00, "currency": "$" }
        ]
      },
      {
        "id": "anker_power",
        "name": "Anker 25000mAh Power Bank",
        "category": "Accessories",
        "image": "https://m.media-amazon.com/images/I/71K65j4IrHL._AC_SL1500_.jpg",
        "description": "24,000mAh 140W fast charging. The gold standard for powering handhelds, phones or even laptops on long trips.",
        "links": [
          { "store": "Amazon", "url": "https://amzn.to/3KJgFII", "price": 109.99, "currency": "$" }
        ]
      },
      {
        "id": "ugreen_power",
        "name": "UGreen 25000mAh Power Bank",
        "category": "Accessories",
        "image": "https://m.media-amazon.com/images/I/61zJaUu71qL._AC_SL1500_.jpg",
        "description": "A cheaper alternative to the Anker 25000mAh power bank.",
        "links": [
          { "store": "Amazon", "url": "https://amzn.to/44p6Iqm", "price": 89.99, "currency": "$" },
          { "store": "AliExpress", "url": "https://s.click.aliexpress.com/e/_c3UhzSaN", "price": 75.79, "currency": "$" }
        ]
      },
      {
        "id": "ugreen_dock",
        "name": "UGreen 9-in-1 Dock",
        "category": "Accessories",
        "image": "https://m.media-amazon.com/images/I/71riM53nk3L._AC_SL1500_.jpg",
        "description": "4K@60Hz HDMI, Gigabit Ethernet, and PD charging. Perfect for handhelds like the Steam Deck and ROG Ally. Also works great with Android handhelds but they have to sit upside down.",
        "links": [
          { "store": "Amazon", "url": "https://amzn.to/4s2934T", "price": 39.99, "currency": "$" },
          { "store": "AliExpress", "url": "https://s.click.aliexpress.com/e/_c3RPVzzX", "price": 84.41, "currency": "$" }
        ]
      },
      {
        "id": "rp_ds_addon",
        "name": "Retroid Dual Screen Add-on",
        "category": "Accessories",
        "image": "https://www.goretroid.com/cdn/shop/files/1_22073d25-7a85-49cc-b893-fbc79dc3ae63_1024x1024@2x.jpg?v=1749457811",
        "description": "Transform your RP5 or Mini into a DS powerhouse with this 5.5\" 1080p AMOLED secondary screen.",
        "links": [
          { "store": "Official", "url": "https://www.goretroid.com/products/retroid-dual-screen-add-on?sca_ref=7339476.fIz7oKv7uT", "price": 69.00, "currency": "$" }
        ]
      },
      {
        "id": "gamesir_g8p",
        "name": "GameSir G8 Plus",
        "category": "Accessories",
        "image": "https://ae-pic-a1.aliexpress-media.com/kf/S3fe49083af5143dfaf0968cf77d823720.jpg_960x960q75.jpg_.avif",
        "description": "The ultimate Bluetooth controller for Android, iOS, and Switch. Hall effect sticks & triggers.",
        "links": [
          { "store": "Amazon", "url": "https://amzn.to/4q4zTqZ", "price": 79.99, "currency": "$" },
          { "store": "AliExpress", "url": "https://s.click.aliexpress.com/e/_c4oCQWGv", "price": 79.99, "currency": "$" }
        ]
      },
      {
        "id": "odin3",
        "name": "AYN Odin 3",
        "category": "Handhelds",
        "badge": "Pre-order üî•",
        "image": "https://www.ayntec.com/cdn/shop/files/d92e076f69cb1a6f81c9bab8cd8f57a2_f21bc7dc-1ec5-4a8c-a0fb-159aecd12d8c_1080x.jpg?v=1761054667",
        "description": "The new standard. Snapdragon 8 Elite, 120Hz AMOLED, and massive 8000mAh battery.",
        "links": [
          { "store": "Official", "url": "https://www.ayntec.com/products/ayn-odin-3?sca_ref=8254425.fM33Fgl5td", "price": 329.00, "currency": "$" }
        ]
      },
      {
        "id": "odin2_portal",
        "name": "AYN Odin2 Portal",
        "category": "Handhelds",
        "image": "https://www.ayntec.com/cdn/shop/files/8b9cc7c9808a81fc8db0eaf67a4d79d7_1080x.jpg?v=1737092883",
        "description": "A stunning 7-inch OLED handheld with Snapdragon 8 Gen 2 performance.",
        "links": [
          { "store": "Official", "url": "https://www.ayntec.com/products/odin2-portal?sca_ref=8254425.fM33Fgl5td", "price": 329.00, "currency": "$" },
          { "store": "Amazon", "url": "https://amzn.to/3YxCgqw", "price": 459.00, "currency": "$" }
        ]
      },
      {
        "id": "ayn_thor",
        "name": "AYN Thor",
        "category": "Handhelds",
        "badge": "Pre-order üî•",
        "image": "https://www.ayntec.com/cdn/shop/files/e50c1d352b31e3f4a65f1f0a706072c3_1080x.jpg?v=1755943485",
        "description": "Dual-screen OLED clamshell design powered by the Snapdragon 8 Gen 2.",
        "links": [
          { "store": "Official", "url": "https://www.ayntec.com/products/ayn-thor?sca_ref=8254425.fM33Fgl5td", "price": 299.00, "currency": "$" }
        ]
      },
      {
        "id": "sd_card",
        "name": "SanDisk Extreme 512GB",
        "category": "Accessories",
        "image": "https://m.media-amazon.com/images/I/61MRn7f3m2L.jpg",
        "description": "Reliable storage for your ROM library.",
        "links": [
          { "store": "Amazon", "url": "https://amzn.to/44tg0ln", "price": 59.99, "currency": "$" }
        ]
      }
    ];
    // --- EMBEDDED DATA END ---

    let traySet = new Set(); 
    let currentView = 'grid'; 

    // --- CURRENCY CONFIG (UPDATED DEC 2025) ---
    let currentCurrency = 'USD';
    
    const exchangeRates = {
        'USD': 1.0,
        'EUR': 0.85,  
        'GBP': 0.75,  
        'KRW': 1465,  
        'CAD': 1.38,  
        'AUD': 1.50   
    };

    const currencySymbols = {
        'USD': '$',
        'EUR': '‚Ç¨',
        'GBP': '¬£',
        'KRW': '‚Ç©',
        'CAD': 'C$',
        'AUD': 'A$'
    };

    // --- HELPER FUNCTIONS ---

    const getCheapestPrice = (item) => {
        let min = Infinity;
        if(!item.links || item.links.length === 0) return 0;

        item.links.forEach(l => {
            if (l.price && l.price > 0 && l.price < min) {
                min = l.price;
            }
        });
        return min === Infinity ? 0 : min;
    };

    const formatPrice = (priceInUSD) => {
        if (!priceInUSD) return 'N/A';
        
        const rate = exchangeRates[currentCurrency] || 1;
        const converted = priceInUSD * rate;
        const symbol = currencySymbols[currentCurrency] || '$';

        if (currentCurrency === 'KRW' || currentCurrency === 'JPY') {
            return `${symbol}${Math.floor(converted).toLocaleString()}`;
        }
        
        return `${symbol}${converted.toFixed(2)}`;
    };
    
    const getCheapestLink = (item) => {
        let min = Infinity;
        let bestLink = null;
        if(!item.links || item.links.length === 0) return null;

        item.links.forEach(l => {
            if (l.price && l.price > 0 && l.price < min) {
                min = l.price;
                bestLink = l;
            }
        });
        return bestLink || item.links[0];
    };

    const findLinkByStore = (item, keywords) => {
        if (!item.links) return null;
        return item.links.find(l => {
            const storeName = l.store.toLowerCase();
            return keywords.some(k => storeName.includes(k));
        });
    };

    // NO FETCH NEEDED! Simply use the variable 'allProducts'
    function loadShop() {
        // Immediately render using the data defined above
        renderProducts(allProducts);
        populateBrands(allProducts);
    }

    function renderProducts(products) {
        const grid = document.getElementById('productGrid');
        
        // Reset Grid Classes
        grid.className = 'transition-all duration-300'; 
        if(currentView === 'compact') {
            grid.classList.add('view-compact');
        } else if (currentView === 'list') {
            grid.classList.add('grid', 'gap-8', 'view-list', 'grid-cols-1');
        } else {
            grid.classList.add('grid', 'gap-8', 'grid-cols-1', 'md:grid-cols-2', 'lg:grid-cols-3');
        }

        grid.innerHTML = '';

        if(products.length === 0) {
            grid.innerHTML = '<div class="col-span-full text-center text-gray-500 retro-font p-10">No items found.</div>';
            return;
        }

        products.forEach(item => {
            const isInTray = traySet.has(item.id);
            const cheapestLink = getCheapestLink(item);
            const priceUSD = cheapestLink ? cheapestLink.price : 0;
            
            // --- RENDER COMPACT ROW ---
            if(currentView === 'compact') {
                const template = document.getElementById('compactTemplate');
                const clone = template.content.cloneNode(true);
                
                clone.querySelector('.c-thumb').src = item.image;
                clone.querySelector('.c-title').textContent = item.name;
                clone.querySelector('.c-cat').textContent = item.category;
                clone.querySelector('.c-price').textContent = formatPrice(priceUSD);
                
                const brandLink = findLinkByStore(item, ['official', 'brand', 'anbernic', 'retroid', 'powkiddy']);
                const aliLink = findLinkByStore(item, ['ali', 'express']);
                const amzLink = findLinkByStore(item, ['amazon']);

                const setupStoreBtn = (selector, linkObj) => {
                    const btn = clone.querySelector(selector);
                    if(linkObj) {
                        btn.href = linkObj.url;
                        btn.classList.add('active');
                    }
                };

                setupStoreBtn('.store-brand', brandLink);
                setupStoreBtn('.store-ali', aliLink);
                setupStoreBtn('.store-amz', amzLink);

                const trayBtn = clone.querySelector('.c-tray-btn');
                trayBtn.dataset.id = item.id; 
                updateCompactTrayBtn(isInTray, trayBtn);

                trayBtn.addEventListener('click', () => toggleTray(item.id));

                grid.appendChild(clone);
            } 
            
            // --- RENDER STANDARD CARD ---
            else {
                const template = document.getElementById('productTemplate');
                const clone = template.content.cloneNode(true);

                const card = clone.querySelector('.product-card');
                card.dataset.id = item.id;

                // *** BADGE LOGIC & COLORS ***
                if (item.badge) {
                    const badge = document.createElement('div');
                    badge.className = 'product-badge';
                    
                    // Strip emojis
                    const cleanText = item.badge.replace(/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g, '').trim();
                    badge.textContent = cleanText;
                    
                    // Apply Different Colors based on Text
                    const lowerText = cleanText.toLowerCase();
                    if (lowerText.includes('pre-order')) {
                        badge.style.backgroundColor = '#ea580c'; // ORANGE
                    } else if (lowerText.includes('recommended')) {
                        badge.style.backgroundColor = '#dc2626'; // RED (Default)
                    } else if (lowerText.includes('value')) {
                        badge.style.backgroundColor = '#16a34a'; // GREEN
                    } else {
                        badge.style.backgroundColor = '#dc2626'; // Default Red
                    }

                    clone.querySelector('.card-img-wrapper').appendChild(badge);
                }

                clone.querySelector('.product-img').src = item.image;
                clone.querySelector('.product-title').textContent = item.name;
                clone.querySelector('.product-desc').textContent = item.description;
                // Category overlay removed from here
                
                const trayBtn = clone.querySelector('.tray-btn');
                trayBtn.dataset.id = item.id; 

                const trayText = clone.querySelector('.tray-btn-text');
                const indicator = clone.querySelector('.in-tray-indicator');

                updateCardTrayBtn(isInTray, trayBtn, trayText, indicator);

                trayBtn.addEventListener('click', () => toggleTray(item.id));

                const linksContainer = clone.querySelector('.product-links');
                item.links.forEach(link => {
                    const isCheapest = link === cheapestLink;
                    const btn = document.createElement('a');
                    btn.href = link.url;
                    btn.target = "_blank";
                    btn.className = `block w-full px-4 text-sm py-3 rounded pixel-btn flex items-center justify-between font-bold ${isCheapest ? 'bg-green-600 hover:bg-green-500 text-white border-2 border-green-400 cheapest-badge' : 'bg-gray-700 hover:bg-gray-600 text-gray-200 border border-gray-600'}`;
                    btn.innerHTML = `
                        <span class="flex items-center gap-2 truncate">
                            ${getStoreIcon(link.store)} 
                            ${link.store}
                        </span>
                        <div class="text-right ml-2">
                            ${isCheapest ? '<span class="text-[9px] bg-yellow-400 text-black px-1 rounded block w-max ml-auto mb-1">BEST</span>' : ''}
                            <span>${formatPrice(link.price)}</span>
                        </div>`;
                    linksContainer.appendChild(btn);
                });

                grid.appendChild(clone);
            }
        });
        
        feather.replace();
        if(currentView !== 'compact') AOS.refresh(); 
    }

    // --- TRAY AND UI LOGIC ---
    function toggleTray(id) {
        if (traySet.has(id)) traySet.delete(id);
        else traySet.add(id);
        
        updateTrayUI();

        const isInTray = traySet.has(id);
        
        const compactBtns = document.querySelectorAll(`.c-tray-btn[data-id="${id}"]`);
        compactBtns.forEach(btn => {
            updateCompactTrayBtn(isInTray, btn);
            feather.replace();
        });

        const cardBtns = document.querySelectorAll(`.tray-btn[data-id="${id}"]`);
        cardBtns.forEach(btn => {
            const textSpan = btn.querySelector('.tray-btn-text');
            const card = btn.closest('.product-card');
            const indicator = card ? card.querySelector('.in-tray-indicator') : null;
            
            updateCardTrayBtn(isInTray, btn, textSpan, indicator);
            feather.replace();
        });
    }

    function updateCardTrayBtn(active, btn, textSpan, indicator) {
        if (active) {
            btn.classList.remove('bg-gray-700', 'hover:bg-gray-600', 'text-white');
            btn.classList.add('bg-yellow-400', 'hover:bg-yellow-300', 'text-black');
            if(textSpan) textSpan.textContent = 'IN TRAY';
            btn.querySelector('i').setAttribute('data-feather', 'check');
            if(indicator) indicator.classList.remove('hidden');
        } else {
            btn.classList.add('bg-gray-700', 'hover:bg-gray-600', 'text-white');
            btn.classList.remove('bg-yellow-400', 'hover:bg-yellow-300', 'text-black');
            if(textSpan) textSpan.textContent = 'ADD TO TRAY';
            btn.querySelector('i').setAttribute('data-feather', 'plus');
            if(indicator) indicator.classList.add('hidden');
        }
    }

    function updateCompactTrayBtn(active, btn) {
        if (active) {
            btn.classList.remove('bg-gray-700', 'text-gray-300');
            btn.classList.add('bg-yellow-400', 'text-black');
            btn.querySelector('i').setAttribute('data-feather', 'check');
        } else {
            btn.classList.add('bg-gray-700', 'text-gray-300');
            btn.classList.remove('bg-yellow-400', 'text-black');
            btn.querySelector('i').setAttribute('data-feather', 'plus');
        }
    }

    function updateTrayUI() {
        const tray = document.getElementById('tray');
        const list = document.getElementById('trayItems');
        const countSpan = document.getElementById('trayCount');
        const totalSpan = document.getElementById('trayTotal');
        
        countSpan.textContent = traySet.size;

        let total = 0;
        let currencySym = currencySymbols[currentCurrency] || '$'; 

        traySet.forEach(id => {
            const item = allProducts.find(p => p.id === id);
            if(item) {
                total += getCheapestPrice(item);
            }
        });
        
        totalSpan.textContent = formatPrice(total);

        if (traySet.size > 0) {
            tray.classList.remove('tray-hidden');
            tray.classList.add('tray-visible');
        } else {
            tray.classList.remove('tray-visible');
            tray.classList.add('tray-hidden');
        }

        list.innerHTML = '';
        traySet.forEach(id => {
            const item = allProducts.find(p => p.id === id);
            if (!item) return;

            const div = document.createElement('div');
            div.className = 'flex-shrink-0 w-48 bg-black/40 border border-gray-600 rounded p-2 flex gap-2 items-center relative group';
            div.innerHTML = `
                <img src="${item.image}" class="w-10 h-10 object-cover rounded bg-black">
                <div class="overflow-hidden">
                    <div class="truncate text-xs font-bold text-gray-200">${item.name}</div>
                    <div class="text-[10px] text-green-400 font-mono">${formatPrice(getCheapestPrice(item))}</div>
                </div>
                <button onclick="removeItem('${item.id}')" class="absolute top-1 right-1 bg-red-500 text-white rounded-full p-0.5 hover:scale-110 transition-transform shadow-md">
                    <i data-feather="x" class="w-3 h-3"></i>
                </button>
            `;
            list.appendChild(div);
        });
        feather.replace();
    }

    window.removeItem = (id) => {
        toggleTray(id);
    };

    document.querySelectorAll('.view-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
            const mode = e.currentTarget.getAttribute('data-view');
            currentView = mode;
            
            document.querySelectorAll('.view-btn').forEach(b => {
                b.classList.remove('text-yellow-400');
                b.classList.add('text-gray-400');
            });
            e.currentTarget.classList.add('text-yellow-400');
            e.currentTarget.classList.remove('text-gray-400');
            
            applyFilters();
        });
    });

    document.getElementById('searchInput').addEventListener('input', applyFilters);
    document.getElementById('brandFilter').addEventListener('change', applyFilters);
    document.getElementById('sortFilter').addEventListener('change', applyFilters);
    
    document.getElementById('currencyFilter').addEventListener('change', (e) => {
        currentCurrency = e.target.value;
        updateTrayUI();
        applyFilters(); 
    });

    document.getElementById('openTrayLinks').addEventListener('click', () => {
        let opened = 0;
        traySet.forEach(id => {
            const item = allProducts.find(p => p.id === id);
            const link = getCheapestLink(item);
            if(link) {
                setTimeout(() => window.open(link.url, '_blank'), opened * 300);
                opened++;
            }
        });
    });

    document.getElementById('clearTray').addEventListener('click', () => {
        traySet.clear();
        updateTrayUI();
        applyFilters();
    });

    function getStoreIcon(storeName) {
        const name = storeName.toLowerCase();
        if(name.includes('amazon')) return '<i data-feather="shopping-cart" class="w-4 h-4"></i>';
        if(name.includes('ali')) return '<i data-feather="package" class="w-4 h-4"></i>';
        if(name.includes('official')) return '<i data-feather="globe" class="w-4 h-4"></i>';
        return '<i data-feather="external-link" class="w-4 h-4"></i>';
    }

    function populateBrands(products) {
        const brandSelect = document.getElementById('brandFilter');
        const brands = new Set();
        
        products.forEach(p => {
            const brand = p.name.split(' ')[0]; 
            brands.add(brand);
        });

        const sortedBrands = Array.from(brands).sort();

        sortedBrands.forEach(brand => {
            const option = document.createElement('option');
            option.value = brand;
            option.textContent = brand.toUpperCase();
            brandSelect.appendChild(option);
        });
    }

    function applyFilters() {
        const term = document.getElementById('searchInput').value.toLowerCase();
        const activeCat = document.querySelector('.filter-btn.bg-yellow-400').dataset.cat;
        const selectedBrand = document.getElementById('brandFilter').value;
        const sortMode = document.getElementById('sortFilter').value;

        let filtered = allProducts.filter(p => {
            const matchesCat = activeCat === 'all' || p.category === activeCat;
            const matchesSearch = p.name.toLowerCase().includes(term) || p.description.toLowerCase().includes(term);
            
            const brand = p.name.split(' ')[0];
            const matchesBrand = selectedBrand === 'all' || brand === selectedBrand;

            return matchesCat && matchesSearch && matchesBrand;
        });

        if (sortMode === 'price-asc') {
            filtered.sort((a, b) => getCheapestPrice(a) - getCheapestPrice(b));
        } else if (sortMode === 'price-desc') {
            filtered.sort((a, b) => getCheapestPrice(b) - getCheapestPrice(a));
        }

        renderProducts(filtered);
    }

    document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
            document.querySelectorAll('.filter-btn').forEach(b => {
                b.classList.remove('bg-yellow-400', 'text-black');
                b.classList.add('bg-gray-700', 'text-white');
            });
            e.target.classList.remove('bg-gray-700', 'text-white');
            e.target.classList.add('bg-yellow-400', 'text-black');

            applyFilters();
        });
    });

    document.addEventListener('DOMContentLoaded', () => {
        AOS.init();
        loadShop();
    });
</script>
</body>
</html>
